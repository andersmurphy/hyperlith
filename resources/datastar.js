// Datastar v1.0.0-RC.2
var gt=/ðŸ–•JS_DSðŸš€/.source,Ae=gt.slice(0,5),re=gt.slice(4),F="datastar",yt="Datastar-Request",bt=1e3,ht="type module",vt=!1,St=!1,Et=!0,qe="morph",Tt="inner",At="outer",xt="prepend",wt="append",Mt="before",Rt="after",Dt="upsertAttributes",Pt=qe,We="datastar-merge-fragments",Ge="datastar-merge-signals",_e="datastar-remove-fragments",je="datastar-remove-signals",Ue="datastar-execute-script";var g=(r=>(r[r.Attribute=1]="Attribute",r[r.Watcher=2]="Watcher",r[r.Action=3]="Action",r))(g||{});var z=`${F}-signal-change`;var X=e=>e.trim()==="true",K=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").replace(/([a-z])([0-9]+)/gi,"$1-$2").replace(/([0-9]+)([a-z])/gi,"$1-$2").toLowerCase(),de=e=>K(e).replace(/-./g,t=>t[1].toUpperCase()),me=e=>K(e).replace(/-/g,"_"),Vn=e=>de(e).replace(/^./,t=>t[0].toUpperCase()),Ct=e=>new Function(`return Object.assign({}, ${e})`)(),J=e=>e.startsWith("$")?e.slice(1):e,On={kebab:K,snake:me,pascal:Vn};function C(e,t){for(let n of t.get("case")||[]){let r=On[n];r&&(e=r(e))}return e}var Hn="computed",kt={type:1,name:Hn,keyReq:1,valReq:1,onLoad:({key:e,mods:t,genRX:n,computed:r,batch:i})=>{e=C(e,t);let{deps:s,rxFn:o}=n();i(()=>{r(s,o,e)})}};var Me=new Set,Re=new Set,De=new Set;function Pe(e){Me.clear(),Re.clear(),De.clear();let t=e();return(Me.size||Re.size||De.size)&&document.dispatchEvent(new CustomEvent(z,{detail:{added:[...Me],removed:[...Re],updated:[...De]}})),t}var O=new Array,Y=new Map;function oe(){return O}function Ye(e){return Y.get(e)}function $n(e){let t=new Array,n=0,r=O.length-1,i=s=>s!==e&&!s.startsWith(`${e}.`);for(;n<=r;){let s=Math.floor((n+r)/2),o=O[s];if(o<e)n=s+1;else if(o>e)r=s-1;else{let a=s;do{let c=O[a];if(i(c))break;a--}while(a>=0);let l=s;do{let c=O[l];if(i(c))break;l++}while(l<O.length);for(let c=a+1;c<l;c++)t.push(O[c]);return t}}return t}function Lt(e,t){Qe(e),O.push(e),Y.set(e,t),O.sort(),Me.add(e)}function W(e,t){let n=Y.get(e);if(n){if(!(n instanceof ie))return;n.value=t}else be(t,e)}function se(e){return Y.get(e)?.value}function ae(e,t){let n=!1,r=Y.get(e);return r||(n=!0,r=be(t,e)),{dep:r,inserted:n}}function Ce(e,t=!1){let n=Ft(e);for(let[r,i]of Object.entries(n))Y.has(r)&&t||W(r,i)}function Qe(...e){for(let t of e){let n=$n(t);for(let r of n){Y.delete(r);let i=O.indexOf(r);i>-1&&O.splice(i,1),Re?.add(r)}}}function ke(e=!0,t=!1){return JSON.stringify(qn(t),null,e?2:0)}function qn(e,...t){let n=new Map;for(let i of O)if(!(e&&i.match(/^_|\._/))){if(t.length>0){let s=!1;for(let o of t)if(i.startsWith(o)){s=!0;break}if(!s)continue}n.set(i,Y.get(i)?.value)}return Gn(n)}function Wn(e){return Object.prototype.toString.call(e)==="[object Object]"}function Ft(e,t=[],n="."){return Object.keys(e).reduce((r,i)=>Object.assign({},r,Wn(e[i])?Ft(e[i],t.concat([i]),n):{[t.concat([i]).join(n)]:e[i]}),{})}function Gn(e,t="."){let n={};for(let[r,i]of e.entries()){let s=r.split(t),o=n;for(let a=0;a<s.length-1;a++){let l=s[a];o[l]||(o[l]={}),o=o[l]}o[s[s.length-1]]=i}return n}function Ze(e,t,n,...r){return Pe(()=>e(...r,...n.map((i,s)=>t[s]?i:i.value)))}var xe=[],ge=[],we=0,ye=0;function et(e,t){switch(e.length){case 0:return t;case 1:return()=>t(e[0].value);case 2:return()=>t(e[0].value,e[1].value);case 3:return()=>t(e[0].value,e[1].value,e[2].value);case 4:return()=>t(e[0].value,e[1].value,e[2].value,e[3].value)}let n=e.length;return xe[n]||(xe[n]=Array(n)),()=>{for(let r=0;r<n;r++)xe[n][r]=e[r].value;return t(...xe[n])}}function Ke(e){e.flags&=-249;let t=e.currentValue,n=e.getter();return t!==n?(e.currentValue=n,!0):!1}function _n(e){let t=e.flags;return(t&32||t&64&&jn(e,t))&&(e.flags&=-249,e.run()),!0}function jn(e,t){return Nt(e.deps)?(e.flags=t|32,!0):(e.flags=t&-65,!1)}function be(e,t){return new ie(e,t)}var ie=class{constructor(t,n){this.currentValue=t;this.path=n;n&&Lt(n,this)}get value(){return this.currentValue}set value(t){if(this.currentValue!==t&&(this.currentValue=t,this.path&&De.add(this.path),this.subs)){let n=this.subs,r=n.nextSub,i,s=0,o=32;e:do{let a=n.sub,l=a.flags,c=!1;if(l&244?l&16&&!(l&4)?(a.flags=l&-17|o|8,c=!0):!(l&224)&&Je(n,a)&&(a.flags=l|16|o|8,c=!!a.subs):(a.flags=l|o|8,c=!0),c){let u=a.subs;if(u){n=u,u.nextSub?(i={target:r,linked:i},++s,r=n.nextSub,o=64):o=l&2?128:64;continue}l&2&&(ge[ye++]=a)}else l&(4|o)?!(l&o)&&l&224&&Je(n,a)&&(a.flags=l|o):(a.flags=l|o|8,(l&10)===2&&(ge[ye++]=a));if(n=r){r=n.nextSub,o=s?64:32;continue}for(;s--;)if(n=i.target,i=i.linked,n){r=n.nextSub,o=s?64:32;continue e}break}while(!0);for(;we<ye;){let a=ge[we];ge[we++]=void 0,_n(a)||(a.flags&=-9)}we=0,ye=0}}};function tt(e,t,n){return new Be(e,et(e,t),n)}var Be=class{constructor(t,n,r){this.path=r;this.flags=33;this.getter=et(t,n),r&&Lt(r,this);for(let i of t)It(i,this)}get value(){let t=this.flags;if(t&96)if(t&32||Nt(this.deps)){if(Ke(this)){let n=this.subs;n&&Xe(n)}}else this.flags=t&-65;return this.currentValue}};function nt(e,t){let n=new ze(e,t);return()=>n.dispose()}var ze=class{constructor(t,n){this.flags=2;for(let r of t)It(r,this);this.run=et(t,n),this.run()}dispose(){if(this.depsTail=void 0,this.flags&=-249,this.deps){let t=this.deps;do{let n=t.dep,r=t.nextDep,i=t.nextSub,s=t.prevSub;if(i?i.prevSub=s:n.subsTail=s,s?s.nextSub=i:n.subs=i,!n.subs&&"deps"in n){let o=n.flags;o&32||(n.flags=o|32);let a=n.deps;if(a){t=a,n.depsTail.nextDep=r,n.deps=void 0,n.depsTail=void 0;continue}}t=r}while(t);this.deps=void 0}}};function It(e,t){let n=t.depsTail;if(n&&n.dep===e)return;let r=n?n.nextDep:t.deps;if(r&&r.dep===e){t.depsTail=r;return}let i=e.subsTail;if(i&&i.sub===t&&Je(i,t))return;let s={dep:e,sub:t,nextDep:r,prevSub:void 0,nextSub:void 0};if(n?n.nextDep=s:t.deps=s,!e.subs)e.subs=s;else{let o=e.subsTail;s.prevSub=o,o.nextSub=s}return t.depsTail=s,e.subsTail=s,s}function Nt(e){let t,n=0,r;e:do{r=!1;let i=e.dep;if(e.sub.flags&32)r=!0;else if("flags"in i){let s=i.flags;if((s&33)===33){if(Ke(i)){let o=i.subs;o.nextSub&&Xe(o),r=!0}}else if((s&65)===65){(e.nextSub||e.prevSub)&&(t={target:e,linked:t}),e=i.deps,++n;continue}}if(!r&&e.nextDep){e=e.nextDep;continue}for(;n;){--n;let s=e.sub,o=s.subs;if(r){if(Ke(s)){o.nextSub?(e=t.target,t=t.linked,Xe(o)):e=o;continue}}else s.flags&=-65;if(o.nextSub?(e=t.target,t=t.linked):e=o,e.nextDep){e=e.nextDep;continue e}r=!1}return r}while(!0)}function Xe(e){do{let t=e.sub,n=t.flags;(n&96)===64&&(t.flags=n|32|8,(n&10)===2&&(ge[ye++]=t)),e=e.nextSub}while(e)}function Je(e,t){let n=t.depsTail;if(n){let r=t.deps;do{if(r===e)return!0;if(r===n)break;r=r.nextDep}while(r)}return!1}var Vt={type:1,name:"signals",onLoad:e=>{let{key:t,mods:n,value:r,genRX:i,evalRX:s,batch:o}=e,a=n.has("ifmissing"),{deps:l,dm:c,rxFn:u}=i();if(t!==""){let p=C(t,n),f=r===""?r:s(u,c,l);o(()=>{a?ae(p,f):W(p,f)})}else{let p=s(u,c,l);o(()=>{Ce(p,a)})}}};var Ot={type:1,name:"star",keyReq:2,valReq:2,onLoad:()=>{alert("YOU ARE PROBABLY OVERCOMPLICATING IT")}};var le=class{#e=0;#t;constructor(t=F){this.#t=t}with(t){if(typeof t=="string")for(let n of t.split(""))this.with(n.charCodeAt(0));else typeof t=="boolean"?this.with(1<<(t?7:3)):this.#e=this.#e*33^t;return this}get value(){return this.#e}get string(){return this.#t+Math.abs(this.#e).toString(36)}};function Le(e){if(e.id)return e.id;let t=new le;for(let[r,i]of Object.entries(e.dataset))t.with(r).with(i||"");let n=e;for(;n;){if(t.with(n.tagName||""),n.id){t.with(n.id);break}let r=n?.parentNode;r&&t.with([...r.children].indexOf(n)),n=r}return t.string}function he(e,t){return new le().with(e).with(t).value}function ce(e,t){if(!e||!(e instanceof HTMLElement||e instanceof SVGElement))return null;let n=e.dataset;if("starIgnore"in n)return null;"starIgnore__self"in n||t(e);let r=e.firstElementChild;for(;r;)ce(r,t),r=r.nextElementSibling}var Un="https://data-star.dev/errors";function Ht(e,t,n={}){let r=new Error;r.name=`${F} ${e} error`;let i=me(t),s=new URLSearchParams({metadata:JSON.stringify(n)}).toString(),o=JSON.stringify(n,null,2);return r.message=`${t}
More info: ${Un}/${e}/${i}?${s}
Context: ${o}`,r}function H(e,t,n={}){let r={plugin:{name:t.plugin.name,type:g[t.plugin.type]}};return Ht("init",e,Object.assign(r,n))}function T(e,t,n={}){let r={plugin:{name:t.plugin.name,type:g[t.plugin.type]},element:{id:t.el.id,tag:t.el.tagName},expression:{rawKey:t.rawKey,key:t.key,value:t.value,validSignals:oe(),fnContent:t.fnContent}};return Ht("runtime",e,Object.assign(r,n))}var ve={},it=[],te=new Map,rt=null,ot="";function $t(e){ot=e}function Fe(...e){for(let t of e){let n={plugin:t,actions:ve,removals:te,applyToElement:Ie,batch:Pe,signal:be,computed:tt,effect:nt,evalRX:Ze},r;switch(t.type){case 3:{ve[t.name]=t;break}case 1:{let i=t;it.push(i),r=i.onGlobalInit;break}case 2:{r=t.onGlobalInit;break}default:throw H("InvalidPluginType",n)}r&&r(n)}it.sort((t,n)=>{let r=n.name.length-t.name.length;return r!==0?r:t.name.localeCompare(n.name)})}function st(){queueMicrotask(()=>{Ie(document.documentElement),Kn()})}function Ie(e){ce(e,t=>{let n=new Array,r=te.get(t.id)||new Map,i=new Map([...r]),s=new Map;for(let[o,a]of Object.entries(t.dataset)){if(!o.startsWith(ot))break;let l=he(o,a||"");s.set(o,l),r.has(l)?i.delete(l):n.push(o)}for(let[o,a]of i)a();for(let o of n){let a=s.get(o);Bn(t,o,a)}})}function Kn(){rt||(rt=new MutationObserver(e=>{let t=new Set,n=new Set;for(let{target:r,type:i,addedNodes:s,removedNodes:o}of e)switch(i){case"childList":{for(let a of o)t.add(a);for(let a of s)n.add(a)}break;case"attributes":{n.add(r);break}}for(let r of t)ce(r,i=>{let s=te.get(i.id);if(s){for(let[o,a]of s)a();te.delete(i.id)}});for(let r of n)Ie(r)}),rt.observe(document.body,{subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0}))}function Bn(e,t,n){let r=de(t.slice(ot.length)),i=it.find(M=>new RegExp(`^${M.name}([A-Z]|_|$)`).test(r));if(!i)return;e.id.length||(e.id=Le(e));let[s,...o]=r.slice(i.name.length).split(/\_\_+/),a=s.length>0;a&&(s=de(s));let l=e.dataset[t]||"",c=l.length>0,u={applyToElement:Ie,actions:ve,removals:te,genRX:()=>zn(u,...i.argNames||[]),plugin:i,el:e,rawKey:r,key:s,value:l,mods:new Map,batch:Pe,signal:be,computed:tt,effect:nt,evalRX:Ze},p=i.keyReq||0;if(a){if(p===2)throw T(`${i.name}KeyNotAllowed`,u)}else if(p===1)throw T(`${i.name}KeyRequired`,u);let f=i.valReq||0;if(c){if(f===2)throw T(`${i.name}ValueNotAllowed`,u)}else if(f===1)throw T(`${i.name}ValueRequired`,u);if(p===3||f===3){if(a&&c)throw T(`${i.name}KeyAndValueProvided`,u);if(!a&&!c)throw T(`${i.name}KeyOrValueRequired`,u)}for(let M of o){let[y,...h]=M.split(".");u.mods.set(de(y),new Set(h.map(v=>v.toLowerCase())))}let m=i.onLoad(u)??(()=>{}),b=te.get(e.id);b||(b=new Map,te.set(e.id,b)),b.set(n,m)}function zn(e,...t){let n=[],r=new Set,i="",s=/(\/(\\\/|[^\/])*\/|"(\\"|[^\"])*"|'(\\'|[^'])*'|`(\\`|[^`])*`|[^;])+/gm,o=e.value.trim().match(s);if(o){let y=o.length-1,h=o[y].trim();h.startsWith("return")||(o[y]=`return (${h});`),i=o.join(`;
`)}let a=new Map,l=new RegExp(`(?:${Ae})(.*?)(?:${re})`,"gm");for(let y of i.matchAll(l)){let h=y[1],v=new le("dsEscaped").with(h).string;a.set(v,h),i=i.replace(Ae+h+re,v)}let c=(y,h)=>`${y}${me(h).replaceAll(/\./g,"_")}`,u=new Set(t),p=oe();if(p.length){let y=new RegExp(`\\$(${p.join("|")})(\\s*[+&^\\/*|-]?=[^=]|\\+\\+|--)`,"gm"),h=[...i.matchAll(y)],v=(A,x,d="")=>{i=i.replaceAll(`$${A[1]}`,x+d)};if(h.length){let A=`${F}Mut_`,x=new Set;for(let d of h){let D=d[1],S=Ye(D),w=c(A,D);S&&!x.has(S)&&(r.add(S),x.add(S),n.push(!0),u.add(w)),v(d,`${w}`,".value")}}let k=new RegExp(`\\$(${p.join("|")})(\\W|$)`,"gm"),N=[...i.matchAll(k)];if(N.length){let A=`${F}Pure_`,x=new Set;for(let d of N){let D=d[1],S=Ye(D),w=c(A,D);S&&!x.has(S)&&(r.add(S),x.add(S),n.push(!1),u.add(w)),v(d,w)}}}let f=new Set,m=new RegExp(`@(${Object.keys(ve).join("|")})\\(`,"gm"),b=[...i.matchAll(m)],M=new Set;if(b.length){let y=`${F}Act_`;for(let h of b){let v=h[1],k=ve[v];if(!k)continue;f.add(v);let N=c(y,v);u.add(N),i=i.replace(`@${v}(`,`${N}(`),M.add((...A)=>k.fn(e,...A))}}for(let[y,h]of a)i=i.replace(y,h);e.fnContent=i;try{let y=new Function("el",...u,i);return{dm:n,deps:[...r],rxFn:(...h)=>{try{return y(e.el,...h,...M)}catch(v){throw T("ExecuteExpression",e,{error:v.message})}}}}catch(y){throw T("GenerateExpression",e,{error:y.message})}}Fe(Ot,Vt,kt);var Q=`${F}-sse`,Ne="started",Ve="finished",qt="error",Wt="retrying",Gt="retrying";function _(e,t){document.addEventListener(Q,n=>{if(n.detail.type!==e)return;let{argsRaw:r}=n.detail;t(r)})}function ue(e,t,n){document.dispatchEvent(new CustomEvent(Q,{detail:{type:e,elId:t,argsRaw:n}}))}var _t=e=>`${e}`.includes("text/event-stream"),j=async(e,t,n,r)=>{let{el:i}=e,s=i.id,{headers:o,contentType:a,includeLocal:l,selector:c,openWhenHidden:u,retryInterval:p,retryScaler:f,retryMaxWaitMs:m,retryMaxCount:b,abort:M}=Object.assign({headers:{},contentType:"json",includeLocal:!1,selector:null,openWhenHidden:!1,retryInterval:bt,retryScaler:2,retryMaxWaitMs:3e4,retryMaxCount:10,abort:void 0},r),y=t.toLowerCase(),h=()=>{};try{if(!n?.length)throw T("SseNoUrlProvided",e,{action:y});let v={};v[yt]=!0,a==="json"&&(v["Content-Type"]="application/json");let k=Object.assign({},v,o),N={method:t,headers:k,openWhenHidden:u,retryInterval:p,retryScaler:f,retryMaxWaitMs:m,retryMaxCount:b,signal:M,onopen:async d=>{if(d.status>=400){let D=d.status.toString();ue(qt,s,{status:D})}},onmessage:d=>{if(!d.event.startsWith(F))return;let D=d.event,S={},w=d.data.split(`
`);for(let E of w){let V=E.indexOf(" "),q=E.slice(0,V),R=S[q];R||(R=[],S[q]=R);let L=E.slice(V+1);R.push(L)}let P={};for(let[E,V]of Object.entries(S))P[E]=V.join(`
`);ue(D,s,P)},onerror:d=>{if(_t(d))throw T("InvalidContentType",e,{url:n});d&&(console.error(d.message),ue(Wt,s,{message:d.message}))}},A=new URL(n,window.location.origin),x=new URLSearchParams(A.search);if(a==="json"){let d=ke(!1,!l);t==="GET"?x.set(F,d):N.body=d}else if(a==="form"){let d=c?document.querySelector(c):i.closest("form");if(d===null)throw c?T("SseFormNotFound",e,{action:y,selector:c}):T("SseClosestFormNotFound",e,{action:y});if(i!==d){let S=w=>w.preventDefault();d.addEventListener("submit",S),h=()=>d.removeEventListener("submit",S)}if(!d.checkValidity()){d.reportValidity(),h();return}let D=new FormData(d);if(t==="GET"){let S=new URLSearchParams(D);for(let[w,P]of S)x.append(w,P)}else N.body=D}else throw T("SseInvalidContentType",e,{action:y,contentType:a});ue(Ne,s,{}),A.search=x.toString();try{await er(A.toString(),s,N)}catch(d){if(!_t(d))throw T("SseFetchFailed",e,{method:t,url:n,error:d})}}finally{ue(Ve,s,{}),h()}};async function Xn(e,t){let n=e.getReader(),r;for(r=await n.read();!r.done;)t(r.value),r=await n.read()}function Jn(e){let t,n,r,i=!1;return function(o){t===void 0?(t=o,n=0,r=-1):t=Qn(t,o);let a=t.length,l=0;for(;n<a;){i&&(t[n]===10&&(l=++n),i=!1);let c=-1;for(;n<a&&c===-1;++n)switch(t[n]){case 58:r===-1&&(r=n-l);break;case 13:i=!0;case 10:c=n;break}if(c===-1)break;e(t.subarray(l,c),r),l=n,r=-1}l===a?t=void 0:l!==0&&(t=t.subarray(l),n-=l)}}function Yn(e,t,n){let r=jt(),i=new TextDecoder;return function(o,a){if(o.length===0)n?.(r),r=jt();else if(a>0){let l=i.decode(o.subarray(0,a)),c=a+(o[a+1]===32?2:1),u=i.decode(o.subarray(c));switch(l){case"data":r.data=r.data?`${r.data}
${u}`:u;break;case"event":r.event=u;break;case"id":e(r.id=u);break;case"retry":{let p=Number.parseInt(u,10);Number.isNaN(p)||t(r.retry=p);break}}}}}function Qn(e,t){let n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}function jt(){return{data:"",event:"",id:"",retry:void 0}}var Zn="text/event-stream",Ut="last-event-id";function er(e,t,{signal:n,headers:r,onopen:i,onmessage:s,onclose:o,onerror:a,openWhenHidden:l,fetch:c,retryInterval:u=1e3,retryScaler:p=2,retryMaxWaitMs:f=3e4,retryMaxCount:m=10,...b}){return new Promise((M,y)=>{let h=0,v={...r};v.accept||(v.accept=Zn);let k;function N(){k.abort(),document.hidden||S()}l||document.addEventListener("visibilitychange",N);let A=0;function x(){document.removeEventListener("visibilitychange",N),window.clearTimeout(A),k.abort()}n?.addEventListener("abort",()=>{x(),M()});let d=c??window.fetch,D=i??function(){};async function S(){k=new AbortController;try{let w=await d(e,{...b,headers:v,signal:k.signal});await D(w),await Xn(w.body,Jn(Yn(P=>{P?v[Ut]=P:delete v[Ut]},P=>{u=P},s))),o?.(),x(),M()}catch(w){if(!k.signal.aborted)try{let P=a?.(w)??u;window.clearTimeout(A),A=window.setTimeout(S,P),u*=p,u=Math.min(u,f),h++,h>=m?(ue(Gt,t,{}),x(),y("Max retries reached.")):console.error(`Datastar failed to reach ${e.toString()} retrying in ${P}ms.`)}catch(P){x(),y(P)}}}S()})}var Kt={type:3,name:"delete",fn:async(e,t,n)=>j(e,"DELETE",t,{...n})};var Bt={type:3,name:"get",fn:async(e,t,n)=>j(e,"GET",t,{...n})};var zt={type:3,name:"patch",fn:async(e,t,n)=>j(e,"PATCH",t,{...n})};var Xt={type:3,name:"post",fn:async(e,t,n)=>j(e,"POST",t,{...n})};var Jt={type:3,name:"put",fn:async(e,t,n)=>j(e,"PUT",t,{...n})};var Yt={type:2,name:Ue,onGlobalInit:async e=>{_(Ue,({autoRemove:t=`${Et}`,attributes:n=ht,script:r})=>{let i=X(t);if(!r?.length)throw H("NoScriptProvided",e);let s=document.createElement("script");for(let o of n.split(`
`)){let a=o.indexOf(" "),l=a?o.slice(0,a):o,c=a?o.slice(a):"";s.setAttribute(l.trim(),c.trim())}s.text=r,document.head.appendChild(s),i&&s.remove()})}};var Se=document,Ee=!!Se.startViewTransition;function U(e,t){if(t.has("viewtransition")&&Ee){let n=e;e=(...r)=>document.startViewTransition(()=>n(...r))}return e}var ln="div",at="value",ut=e=>document.createElement(e),cn=()=>ut(ln),tr=e=>`<${e}></${e}>`,Qt=e=>[...e.querySelectorAll("[id]")],un=e=>e instanceof Element,Zt=e=>e instanceof HTMLTemplateElement,en=e=>e instanceof HTMLInputElement,tn=e=>e instanceof HTMLTextAreaElement,nn=e=>e instanceof HTMLOptionElement,pn={type:2,name:We,onGlobalInit:async e=>{let t=ut("template");_(We,({fragments:n=tr(ln),selector:r="",mergeMode:i=Pt,useViewTransition:s="false"})=>{let o=X(s);t.innerHTML=n.trim();let a=[...t.content.children];for(let l of a){if(!un(l))throw H("NoFragmentsFound",e);let c=r||`#${l.getAttribute("id")}`,u=[...document.querySelectorAll(c)||[]];if(!u.length)throw H("NoTargetsFound",e,{selectorOrID:c});o&&Ee?Se.startViewTransition(()=>rn(e,i,l,u)):rn(e,i,l,u)}})}};function rn(e,t,n,r){for(let i of r){i.dataset.fragmentMergeTarget="true";let s=n.cloneNode(!0);switch(t){case qe:{ce(s,o=>{!o.id?.length&&Object.keys(o.dataset).length&&(o.id=Le(o));let a=e.removals.get(o.id);if(a){for(let[l,c]of Object.entries(o.dataset))if(l.startsWith("bind")){let u=he(l,c||""),p=a.get(u);if(p){a.delete(u);let f=he(u,u);a.set(f,p)}}}}),nr(i,s);break}case Tt:i.innerHTML=s.outerHTML;break;case At:i.replaceWith(s);break;case xt:i.prepend(s);break;case wt:i.append(s);break;case Mt:i.before(s);break;case Rt:i.after(s);break;case Dt:for(let o of s.getAttributeNames()){let a=s.getAttribute(o);i.setAttribute(o,a)}break;default:throw H("InvalidMergeMode",e,{mergeMode:t})}}}var Te=cn();Te.hidden=!0;var Oe,$=new Map,pe=new Set;function nr(e,t){e instanceof Document&&(e=e.documentElement);let n,r=cn();if(t instanceof Node)r.append(t),n=r;else{for(let m of[...t])r.append(m);n=r}let i=Qt(n),s=Qt(e);e.id&&s.push(e);let o=new Set,a=new Map;for(let{id:m,tagName:b}of s)a.has(m)?o.add(m):a.set(m,b);pe.clear();for(let{id:m,tagName:b}of i)pe.has(m)?o.add(m):a.get(m)===b&&pe.add(m);for(let m of o)pe.delete(m);$.clear(),an(e.parentElement,s),an(n,i),document.body.insertAdjacentElement("afterend",Te),Oe=e;let l=e.parentNode,c=e.previousSibling,u=e.nextSibling;fn(l,n,e,u);let p=new Array,f=c?.nextSibling||l.firstChild;for(;f&&f!==u;)p.push(f),f=f.nextSibling;return Te.remove(),p}function fn(e,t,n=null,r=null){Zt(e)&&Zt(t)&&(e=e.content,t=t.content),n??=e.firstChild;for(let i of t.childNodes){if(n&&n!==r){let o=rr(i,n,r);if(o){if(o!==n){let a=n;for(;a&&a!==o;){let l=a;a=a.nextSibling,sn(l)}}lt(o,i),n=o.nextSibling;continue}}if(un(i)&&pe.has(i.id)){let o=i.id,a=`[id="${o}"]`,l=p=>p.querySelector(a),c=Oe.id===o&&Oe||l(Oe)||l(Te),u=c;for(;u=u.parentNode;){let p=$.get(u);p&&(p.delete(c.id),p.size||$.delete(u))}dn(e,c,n),lt(c,i),n=c.nextSibling;continue}if($.has(i)){let o=ut(i.tagName);return e.insertBefore(o,n),lt(o,i),o}let s=document.importNode(i,!0);e.insertBefore(s,n)}for(;n&&n!==r;){let i=n;n=n.nextSibling,sn(i)}}function rr(e,t,n){let r=null,i=e.nextSibling,s=0,o=0,a=$.get(e)?.size||0,l=t;for(;l&&l!==n;){if(on(l,e)){let c=!1,u=$.get(l),p=$.get(e);if(p&&u){for(let f of u)if(p.has(f)){c=!0;break}}if(c)return l;if(!r&&!$.has(l)){if(!a)return l;r=l}}if(o+=$.get(l)?.size||0,o>a||(r===null&&i&&on(l,i)&&(s++,i=i.nextSibling,s>=2&&(r=void 0)),l.contains(document.activeElement)))break;l=l.nextSibling}return r||null}function on(e,t){let n=e,r=t;return n.nodeType===r.nodeType&&n.tagName===r.tagName&&(!n.id||n.id===r.id)}function sn(e){$.has(e)?dn(Te,e,null):e.parentNode?.removeChild(e)}function dn(e,t,n=null){try{e.moveBefore(t,n)}catch{e.insertBefore(t,n)}}function lt(e,t){let n=t.nodeType,r=e,i=t;if(n===1){let s=r.attributes,o=i.attributes;for(let a of o)r.getAttribute(a.name)!==a.value&&r.setAttribute(a.name,a.value);for(let a=s.length-1;0<=a;a--){let l=s[a];l&&(i.hasAttribute(l.name)||r.removeAttribute(l.name))}if(en(r)&&en(i)&&i.type!=="file"){let a=i.value,l=r.value;ct(r,i,"checked"),ct(r,i,"disabled"),i.hasAttribute(at)?l!==a&&(r.setAttribute(at,a),r.value=a):(r.value="",r.removeAttribute(at))}else if(nn(r)&&nn(i))ct(r,i,"selected");else if(tn(r)&&tn(i)){let a=i.value,l=r.value;a!==l&&(r.value=a),r.firstChild&&r.firstChild.nodeValue!==a&&(r.firstChild.nodeValue=a)}}return(n===8||n===3)&&e.nodeValue!==t.nodeValue&&(e.nodeValue=t.nodeValue),r.innerHTML!==i.innerHTML&&fn(r,i),e}function ct(e,t,n){let r=t,i=e,s=r[n],o=i[n];s!==o&&(i[n]=r[n],s?e.setAttribute(n,""):e.removeAttribute(n))}function an(e,t){for(let n of t)if(pe.has(n.id)){let r=n;for(;r&&r!==e;){let i=$.get(r);i||(i=new Set,$.set(r,i)),i.add(n.id),r=r.parentElement}}}var mn={type:2,name:Ge,onGlobalInit:async({batch:e})=>{_(Ge,({signals:t="{}",onlyIfMissing:n=`${St}`})=>{let r=X(n),i=Ct(t);e(()=>Ce(i,r))})}};var gn={type:2,name:_e,onGlobalInit:async e=>{_(_e,({selector:t,useViewTransition:n=`${vt}`})=>{if(!t.length)throw H("NoSelectorProvided",e);let r=X(n),i=document.querySelectorAll(t),s=()=>{for(let o of i)o.remove()};r&&Ee?Se.startViewTransition(()=>s()):s()})}};var yn={type:2,name:je,onGlobalInit:async e=>{let{batch:t}=e;_(je,({paths:n=""})=>{let r=n.split(`
`).map(i=>i.trim());if(!r?.length)throw H("NoPathsProvided",e);t(()=>{Qe(...r)})})}};var bn={type:1,name:"attr",valReq:1,onLoad:({el:e,key:t,genRX:n,computed:r,effect:i})=>{let{deps:s,rxFn:o}=n();if(t===""){let l=r(s,o);return i([l],async c=>{for(let[u,p]of Object.entries(c))p===!1?e.removeAttribute(u):e.setAttribute(u,p)})}t=K(t);let a=r(s,o);return i([a],async l=>{let c;typeof l=="string"?c=l:c=JSON.stringify(l),!c||c==="false"||c==="null"||c==="undefined"?e.removeAttribute(t):e.setAttribute(t,c)})}};var ir=/^data:(?<mime>[^;]+);base64,(?<contents>.*)$/,hn=["change","input","keydown"],vn={type:1,name:"bind",keyReq:3,valReq:3,onLoad:e=>{let{el:t,key:n,mods:r,value:i,effect:s,batch:o}=e,a=t,l=n?C(n,r):J(i),c=t.tagName.toLowerCase(),u=c.includes("input"),p=c.includes("select"),f=t.getAttribute("type"),m=t.hasAttribute("value"),b="",M=u&&f==="checkbox";M&&(b=m?"":!1);let y=u&&f==="number";y&&(b=0);let h=u&&f==="radio";h&&(t.getAttribute("name")?.length||t.setAttribute("name",l));let v=u&&f==="file",{dep:k,inserted:N}=o(()=>ae(l,b)),A=-1;Array.isArray(k.value)&&(t.getAttribute("name")===null&&t.setAttribute("name",l),A=[...document.querySelectorAll(`[name="${l}"]`)].findIndex(E=>E===e.el));let x=A>=0,d=()=>[...se(l)],D=()=>{let E=se(l);x&&!p&&(E=E[A]||b);let V=`${E}`;if(M||h)typeof E=="boolean"?a.checked=E:a.checked=V===a.value;else if(p){let q=t;if(q.multiple){if(!x)throw T("BindSelectMultiple",e);for(let R of q.options){if(R?.disabled)continue;let L=y?Number(R.value):R.value;R.selected=E.includes(L)}}else q.value=V}else v||("value"in t?t.value=V:t.setAttribute("value",V))},S=async()=>{let E=se(l);if(x){let L=E;for(;A>=L.length;)L.push(b);E=L[A]||b}let V=(L,B)=>{let G=B;x&&!p&&!v&&(G=d(),G[A]=B),W(L,G)};if(v){let L=[...a?.files||[]],B=[],G=[],dt=[];await Promise.all(L.map(mt=>new Promise(Nn=>{let ee=new FileReader;ee.onload=()=>{if(typeof ee.result!="string")throw T("InvalidFileResultType",e,{resultType:typeof ee.result});let $e=ee.result.match(ir);if(!$e?.groups)throw T("InvalidDataUri",e,{result:ee.result});B.push($e.groups.contents),G.push($e.groups.mime),dt.push(mt.name)},ee.onloadend=()=>Nn(void 0),ee.readAsDataURL(mt)}))),o(()=>{V(l,B),V(`${l}Mimes`,G),V(`${l}Names`,dt)});return}let q=a.value||"",R;if(M){let L=a.checked||a.getAttribute("checked")==="true";m?R=L?q:"":R=L}else if(p){let B=[...t.selectedOptions];x?R=B.filter(G=>G.selected).map(G=>G.value):R=B[0]?.value||b}else typeof E=="boolean"?R=!!q:typeof E=="number"?R=Number(q):R=q||"";o(()=>{V(l,R)})};N&&S();for(let E of hn)t.addEventListener(E,S);let w=E=>{E.persisted&&S()};window.addEventListener("pageshow",w);let P=s([k],()=>D());return()=>{P();for(let E of hn)t.removeEventListener(E,S);window.removeEventListener("pageshow",w)}}};var Sn={type:1,name:"class",valReq:1,onLoad:({el:e,key:t,mods:n,genRX:r,computed:i,effect:s})=>{let o=e.classList,{deps:a,rxFn:l}=r(),c=i(a,l);return s([c],u=>{if(t===""){let p=u;for(let[f,m]of Object.entries(p)){let b=f.split(/\s+/);m?o.add(...b):o.remove(...b)}}else{let p=K(t);p=C(p,n),u?o.add(p):o.remove(p)}})}};var En={type:1,name:"indicator",keyReq:3,valReq:3,onLoad:e=>{let{el:t,key:n,mods:r,value:i,batch:s}=e,o=n?C(n,r):J(i),{dep:a}=s(()=>ae(o,!1));if(!(a instanceof ie))throw T("not_signal",e,{signalName:o});let l=c=>{let{type:u,elId:p}=c.detail;if(p===t.id)switch(u){case Ne:a.value=!0;break;case Ve:a.value=!1;break}};return document.addEventListener(Q,l),()=>{a.value=!1,document.removeEventListener(Q,l)}}};var Tn={type:1,name:"jsonSignals",keyReq:2,valReq:2,onLoad:e=>{let{el:t}=e;t instanceof HTMLElement||T("JsonSignalsInvalidElement",e);let n=()=>{t.textContent=ke(!0)};return n(),document.addEventListener(z,n),()=>{document.removeEventListener(z,n)}}};function Z(e){if(!e||e.size<=0)return 0;for(let t of e){if(t.endsWith("ms"))return Number(t.replace("ms",""));if(t.endsWith("s"))return Number(t.replace("s",""))*1e3;try{return Number.parseFloat(t)}catch{}}return 0}function ne(e,t,n=!1){return e?e.has(t.toLowerCase()):n}function pt(e,t){return(...n)=>{setTimeout(()=>{e(...n)},t)}}function or(e,t,n=!1,r=!0){let i=-1,s=()=>i&&clearTimeout(i);return(...o)=>{s(),n&&!i&&e(...o),i=setTimeout(()=>{r&&e(...o),s()},t)}}function sr(e,t,n=!0,r=!1){let i=!1;return(...s)=>{i||(n&&e(...s),i=!0,setTimeout(()=>{i=!1,r&&e(...s)},t))}}function fe(e,t){let n=t.get("delay");if(n){let s=Z(n);e=pt(e,s)}let r=t.get("debounce");if(r){let s=Z(r),o=ne(r,"leading",!1),a=!ne(r,"notrail",!1);e=or(e,s,o,a)}let i=t.get("throttle");if(i){let s=Z(i),o=!ne(i,"noleading",!1),a=ne(i,"trail",!1);e=sr(e,s,o,a)}return e}var An={type:1,name:"on",keyReq:1,valReq:1,argNames:["evt"],onLoad:({el:e,key:t,mods:n,genRX:r,evalRX:i})=>{let s=e;n.has("window")&&(s=window);let{dm:o,deps:a,rxFn:l}=r(),c=m=>{m&&((n.has("prevent")||t==="submit")&&m.preventDefault(),n.has("stop")&&m.stopPropagation()),i(l,o,a,m)};c=fe(c,n),c=U(c,n);let u={capture:!1,passive:!1,once:!1};if(n.has("capture")&&(u.capture=!0),n.has("passive")&&(u.passive=!0),n.has("once")&&(u.once=!0),n.has("outside")){s=document;let m=c;c=M=>{let y=M?.target;e.contains(y)||m(M)}}let f=K(t);return f=C(f,n),f===Q&&(s=document),s.addEventListener(f,c,u),()=>{s.removeEventListener(f,c)}}};var xn={type:1,name:"onIntersect",keyReq:2,onLoad:({el:e,rawKey:t,mods:n,genRX:r,evalRX:i})=>{let{dm:s,deps:o,rxFn:a}=r(),l=()=>i(a,s,o);l=fe(l,n),l=U(l,n);let c={threshold:0};n.has("full")?c.threshold=1:n.has("half")&&(c.threshold=.5);let u=new IntersectionObserver(p=>{for(let f of p)f.isIntersecting&&(l(),n.has("once")&&(u.disconnect(),delete e.dataset[t]))},c);return u.observe(e),()=>u.disconnect()}};var wn={type:1,name:"onInterval",keyReq:2,valReq:1,onLoad:({mods:e,genRX:t,evalRX:n})=>{let{dm:r,deps:i,rxFn:s}=t(),o=()=>n(s,r,i);o=U(o,e);let a=1e3,l=e.get("duration");l&&(a=Z(l),ne(l,"leading",!1)&&o());let c=setInterval(o,a);return()=>{clearInterval(c)}}};var Mn={type:1,name:"onLoad",keyReq:2,valReq:1,onLoad:({mods:e,genRX:t,evalRX:n})=>{let{dm:r,deps:i,rxFn:s}=t(),o=()=>n(s,r,i);o=U(o,e);let a=0,l=e.get("delay");l&&(a=Z(l)),o=pt(o,a),o()}};function ft(e,t){return t=t.replaceAll(".","\\.").replaceAll("**",re).replaceAll("*","[^\\.]*").replaceAll(re,".*"),new RegExp(`^${t}$`).test(e)}function He(e){let t=[],n=e.split(/\s+/).filter(r=>r!=="");n=n.map(r=>J(r));for(let r of n)for(let i of oe())ft(i,r)&&t.push(i);return t}var Rn={type:1,name:"onSignalChange",valReq:1,argNames:["evt"],onLoad:({key:e,mods:t,genRX:n,evalRX:r})=>{let{dm:i,deps:s,rxFn:o}=n(),a=c=>r(o,i,s,c);a=fe(a,t),a=U(a,t);let l=c=>{if(e!==""){let u=C(e,t),{added:p,removed:f,updated:m}=c.detail;if(![...p,...f,...m].some(b=>ft(b,u)))return}a(c)};return document.addEventListener(z,l),()=>{document.removeEventListener(z,l)}}};var Dn={type:1,name:"ref",keyReq:3,valReq:3,onLoad:({el:e,key:t,mods:n,value:r,batch:i})=>{let s=t?C(t,n):J(r);i(()=>{W(s,e)})}};var Pn="none",Cn="display",kn={type:1,name:"show",keyReq:2,valReq:1,onLoad:({el:{style:e},genRX:t,computed:n,effect:r})=>{let{deps:i,rxFn:s}=t(),o=n(i,s);return r([o],async a=>{a?e.display===Pn&&e.removeProperty(Cn):e.setProperty(Cn,Pn)})}};var Ln={type:1,name:"text",keyReq:2,valReq:1,onLoad:e=>{let{el:t,genRX:n,computed:r,effect:i}=e,{deps:s,rxFn:o}=n();t instanceof HTMLElement||T("TextInvalidElement",e);let a=r(s,o);return i([a],l=>{t.textContent=`${l}`})}};var Fn={type:3,name:"setAll",fn:({batch:e},t,n)=>{e(()=>{let r=He(t);for(let i of r)W(i,n)})}};var In={type:3,name:"toggleAll",fn:({batch:e},t)=>{e(()=>{let n=He(t);for(let r of n)W(r,!se(r))})}};Fe(Bt,Xt,Jt,zt,Kt,pn,mn,gn,yn,Yt,bn,vn,Sn,En,Tn,An,xn,wn,Mn,Rn,Dn,kn,Ln,Fn,In);st();export{st as apply,Fe as load,$t as setAlias};
//# sourceMappingURL=datastar.js.map
