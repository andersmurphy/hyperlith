// Datastar v1.0.0-RC.7
var ct=/ðŸ–•JS_DSðŸš€/.source,Ge=ct.slice(0,5),je=ct.slice(4),G="datastar-fetch",ee="datastar-signal-patch";var N=Object.hasOwn??Object.prototype.hasOwnProperty.call;var J=e=>e!==null&&typeof e=="object"&&(Object.getPrototypeOf(e)===Object.prototype||Object.getPrototypeOf(e)===null),lt=e=>{for(let t in e)if(N(e,t))return!1;return!0},te=(e,t)=>{for(let n in e){let r=e[n];J(r)||Array.isArray(r)?te(r,t):e[n]=t(r)}},Me=e=>{let t={};for(let[n,r]of e){let s=n.split("."),i=s.pop(),o=s.reduce((a,c)=>a[c]??={},t);o[i]=r}return t};var xe=[],We=[],Oe=0,Le=0,Be=0,Ue,j,Ne=0,M=()=>{Oe++},x=()=>{--Oe||(dt(),z())},C=e=>{Ue=j,j=e},F=()=>{j=Ue,Ue=void 0},ge=e=>Jt.bind(0,{previousValue:e,t:e,e:1}),Ke=Symbol("computed"),ke=e=>{let t=zt.bind(0,{e:17,getter:e});return t[Ke]=1,t},T=e=>{let t={d:e,e:2};j&&ze(t,j),C(t),M();try{t.d()}finally{x(),F()}return ht.bind(0,t)},dt=()=>{for(;Le<Be;){let e=We[Le];We[Le++]=void 0,gt(e,e.e&=-65)}Le=0,Be=0},ut=e=>"getter"in e?mt(e):pt(e,e.t),mt=e=>{C(e),yt(e);try{let t=e.t;return t!==(e.t=e.getter(t))}finally{F(),bt(e)}},pt=(e,t)=>(e.e=1,e.previousValue!==(e.previousValue=t)),Je=e=>{let t=e.e;if(!(t&64)){e.e=t|64;let n=e.r;n?Je(n.o):We[Be++]=e}},gt=(e,t)=>{if(t&16||t&32&&vt(e.s,e)){C(e),yt(e),M();try{e.d()}finally{x(),F(),bt(e)}return}t&32&&(e.e=t&-33);let n=e.s;for(;n;){let r=n.c,s=r.e;s&64&&gt(r,r.e=s&-65),n=n.i}},Jt=(e,...t)=>{if(t.length){if(e.t!==(e.t=t[0])){e.e=17;let r=e.r;return r&&(Qt(r),Oe||dt()),!0}return!1}let n=e.t;if(e.e&16&&pt(e,n)){let r=e.r;r&&Pe(r)}return j&&ze(e,j),n},zt=e=>{let t=e.e;if(t&16||t&32&&vt(e.s,e)){if(mt(e)){let n=e.r;n&&Pe(n)}}else t&32&&(e.e=t&-33);return j&&ze(e,j),e.t},ht=e=>{let t=e.s;for(;t;)t=Fe(t,e);let n=e.r;n&&Fe(n),e.e=0},ze=(e,t)=>{let n=t.a;if(n&&n.c===e)return;let r=n?n.i:t.s;if(r&&r.c===e){r.m=Ne,t.a=r;return}let s=e.p;if(s&&s.m===Ne&&s.o===t)return;let i=t.a=e.p={m:Ne,c:e,o:t,l:n,i:r,u:s};r&&(r.l=i),n?n.i=i:t.s=i,s?s.n=i:e.r=i},Fe=(e,t=e.o)=>{let n=e.c,r=e.l,s=e.i,i=e.n,o=e.u;if(s?s.l=r:t.a=r,r?r.i=s:t.s=s,i?i.u=o:n.p=o,o)o.n=i;else if(!(n.r=i))if("getter"in n){let a=n.s;if(a){n.e=17;do a=Fe(a,n);while(a)}}else"previousValue"in n||ht(n);return s},Qt=e=>{let t=e.n,n;e:for(;;){let r=e.o,s=r.e;if(s&60?s&12?s&4?!(s&48)&&Zt(e,r)?(r.e=s|40,s&=1):s=0:r.e=s&-9|32:s=0:r.e=s|32,s&2&&Je(r),s&1){let i=r.r;if(i){let o=(e=i).n;o&&(n={t,f:n},t=o);continue}}if(e=t){t=e.n;continue}for(;n;)if(e=n.t,n=n.f,e){t=e.n;continue e}break}},yt=e=>{Ne++,e.a=void 0,e.e=e.e&-57|4},bt=e=>{let t=e.a,n=t?t.i:e.s;for(;n;)n=Fe(n,e);e.e&=-5},vt=(e,t)=>{let n,r=0,s=!1;e:for(;;){let i=e.c,o=i.e;if(t.e&16)s=!0;else if((o&17)===17){if(ut(i)){let a=i.r;a.n&&Pe(a),s=!0}}else if((o&33)===33){(e.n||e.u)&&(n={t:e,f:n}),e=i.s,t=i,++r;continue}if(!s){let a=e.i;if(a){e=a;continue}}for(;r--;){let a=t.r,c=a.n;if(c?(e=n.t,n=n.f):e=a,s){if(ut(t)){c&&Pe(a),t=e.o;continue}s=!1}else t.e&=-33;if(t=e.o,e.i){e=e.i;continue e}}return s}},Pe=e=>{do{let t=e.o,n=t.e;(n&48)===32&&(t.e=n|16,n&2&&Je(t))}while(e=e.n)},Zt=(e,t)=>{let n=t.a;for(;n;){if(n===e)return!0;n=n.l}return!1},oe=e=>{let t=ne,n=e.split(".");for(let r of n){if(t==null||!N(t,r))return;t=t[r]}return t},Ce=(e,t="")=>{let n=Array.isArray(e);if(n||J(e)){let r=n?[]:{};for(let i in e)r[i]=ge(Ce(e[i],`${t+i}.`));let s=ge(0);return new Proxy(r,{get(i,o){if(!(o==="toJSON"&&!N(r,o)))return n&&o in Array.prototype?(s(),r[o]):typeof o=="symbol"?r[o]:((!N(r,o)||r[o]()==null)&&(r[o]=ge(""),z(t+o,""),s(s()+1)),r[o]())},set(i,o,a){let c=t+o;if(n&&o==="length"){let l=r[o]-a;if(r[o]=a,l>0){let u={};for(let d=a;d<r[o];d++)u[d]=null;z(t.slice(0,-1),u),s(s()+1)}}else if(N(r,o))if(a==null)delete r[o];else if(N(a,Ke))r[o]=a,z(c,"");else{let l=r[o](),u=`${c}.`;if(J(l)&&J(a)){for(let d in l)N(a,d)||(delete l[d],z(u+d,null));for(let d in a){let h=a[d];l[d]!==h&&(l[d]=h)}}else r[o](Ce(a,u))&&z(c,a)}else a!=null&&(N(a,Ke)?(r[o]=a,z(c,"")):(r[o]=ge(Ce(a,`${c}.`)),z(c,a)),s(s()+1));return!0},deleteProperty(i,o){return delete r[o],s(s()+1),!0},ownKeys(){return s(),Reflect.ownKeys(r)},has(i,o){return s(),o in r}})}return e},z=(e,t)=>{if(e!==void 0&&t!==void 0&&xe.push([e,t]),!Oe&&xe.length){let n=Me(xe);xe.length=0,document.dispatchEvent(new CustomEvent(ee,{detail:n}))}},P=(e,{ifMissing:t}={})=>{M();for(let n in e)e[n]==null?t||delete ne[n]:Et(e[n],n,ne,"",t);x()},A=(e,t)=>P(Me(e),t),Et=(e,t,n,r,s)=>{if(J(e)){N(n,t)&&(J(n[t])||Array.isArray(n[t]))||(n[t]={});for(let i in e)e[i]==null?s||delete n[t][i]:Et(e[i],i,n[t],`${r+t}.`,s)}else s&&N(n,t)||(n[t]=e)},ft=e=>typeof e=="string"?RegExp(e.replace(/^\/|\/$/g,"")):e,D=({include:e=/.*/,exclude:t=/(?!)/}={},n=ne)=>{let r=ft(e),s=ft(t),i=[],o=[[n,""]];for(;o.length;){let[a,c]=o.pop();for(let l in a){let u=c+l;J(a[l])?o.push([a[l],`${u}.`]):r.test(u)&&!s.test(u)&&i.push([u,oe(u)])}}return Me(i)},ne=Ce({});var Q=e=>e instanceof HTMLElement||e instanceof SVGElement||e instanceof MathMLElement;var he=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").replace(/([a-z])([0-9]+)/gi,"$1-$2").replace(/([0-9]+)([a-z])/gi,"$1-$2").replace(/[\s_]+/g,"-").toLowerCase();var St=e=>he(e).replace(/-/g,"_");var ae=e=>{try{return JSON.parse(e)}catch{return Function(`return (${e})`)()}},Tt={camel:e=>e.replace(/-[a-z]/g,t=>t[1].toUpperCase()),snake:e=>e.replace(/-/g,"_"),pascal:e=>e[0].toUpperCase()+Tt.camel(e.slice(1))},L=(e,t,n="camel")=>{for(let r of t.get("case")||[n])e=Tt[r]?.(e)||e;return e},W=e=>`data-${e}`;var Yt="https://data-star.dev/errors",ye=(e,t,n={})=>{Object.assign(n,e);let r=new Error,s=St(t),i=new URLSearchParams({metadata:JSON.stringify(n)}).toString(),o=JSON.stringify(n,null,2);return r.message=`${t}
More info: ${Yt}/${s}?${i}
Context: ${o}`,r},be=new Map,Qe=new Map,wt=new Map,Rt=new Proxy({},{get:(e,t)=>be.get(t)?.apply,has:(e,t)=>be.has(t),ownKeys:()=>Reflect.ownKeys(be),set:()=>!1,deleteProperty:()=>!1}),ve=new Map,He=[],Ze=new Set,Xt=new WeakSet,p=e=>{He.push(e),He.length===1&&setTimeout(()=>{for(let t of He)Ze.add(t.name),Qe.set(t.name,t);He.length=0,sn(),Ze.clear()})},O=e=>{be.set(e.name,e)};document.addEventListener(G,e=>{let t=wt.get(e.detail.type);t&&t.apply({error:ye.bind(0,{plugin:{type:"watcher",name:t.name},element:{id:e.target.id,tag:e.target.tagName}})},e.detail.argsRaw)});var Ee=e=>{wt.set(e.name,e)},At=e=>{for(let t of e){let n=ve.get(t);if(n&&ve.delete(t))for(let r of n.values())for(let s of r.values())s()}},Mt=W("ignore"),en=`[${Mt}]`,xt=e=>e.hasAttribute(`${Mt}__self`)||!!e.closest(en),_e=(e,t)=>{for(let n of e)if(!xt(n)){let r=new Set;for(let s in n.dataset){let i=s.replace(/[A-Z]/g,"-$&").toLowerCase();r.add(i),Ye(n,i,n.dataset[s],t)}for(let s of Array.from(n.attributes)){if(!s.name.startsWith("data-"))continue;let i=s.name.slice(5);r.has(i)||Ye(n,i,s.value,t)}}},tn=e=>{for(let{target:t,type:n,attributeName:r,addedNodes:s,removedNodes:i}of e)if(n==="childList"){for(let o of i)Q(o)&&(At([o]),At(o.querySelectorAll("*")));for(let o of s)Q(o)&&(_e([o]),_e(o.querySelectorAll("*")))}else if(n==="attributes"&&r.startsWith("data-")&&Q(t)&&!xt(t)){let o=r.slice(5),a=t.getAttribute(r);if(a===null){let c=ve.get(t);if(c){let l=c.get(o);if(l){for(let u of l.values())u();c.delete(o)}}}else Ye(t,o,a)}},nn=new MutationObserver(tn),rn=e=>{let[t,...n]=e.split("__"),[r,s]=t.split(/:(.+)/),i=new Map;for(let o of n){let[a,...c]=o.split(".");i.set(a,new Set(c))}return{pluginName:r,key:s,mods:i}};var sn=(e=document.documentElement,t=!0)=>{Q(e)&&_e([e],!0),_e(e.querySelectorAll("*"),!0),t&&(nn.observe(e,{subtree:!0,childList:!0,attributes:!0}),Xt.add(e))};var Ye=(e,t,n,r)=>{{let s=t,{pluginName:i,key:o,mods:a}=rn(s),c=Qe.get(i);if((!r||Ze.has(i))&&!!c){let u={el:e,rawKey:s,mods:a,error:ye.bind(0,{plugin:{type:"attribute",name:c.name},element:{id:e.id,tag:e.tagName},expression:{rawKey:s,key:o,value:n}}),key:o,value:n,loadedPluginNames:{actions:new Set(be.keys()),attributes:new Set(Qe.keys())},rx:void 0},d=c.requirement&&(typeof c.requirement=="string"?c.requirement:c.requirement.key)||"allowed",h=c.requirement&&(typeof c.requirement=="string"?c.requirement:c.requirement.value)||"allowed",f=o!=null&&o!=="",m=n!=null&&n!=="";if(f){if(d==="denied")throw u.error("KeyNotAllowed")}else if(d==="must")throw u.error("KeyRequired");if(m){if(h==="denied")throw u.error("ValueNotAllowed")}else if(h==="must")throw u.error("ValueRequired");if(d==="exclusive"||h==="exclusive"){if(f&&m)throw u.error("KeyAndValueProvided");if(!f&&!m)throw u.error("KeyOrValueRequired")}let g=new Map;if(m){let S;u.rx=(...H)=>(S||(S=on(n,{returnsValue:c.returnsValue,argNames:c.argNames,cleanups:g})),S(e,...H))}let E=c.apply(u);E&&g.set("attribute",E);let R=ve.get(e);if(R){let S=R.get(s);if(S)for(let H of S.values())H()}else R=new Map,ve.set(e,R);R.set(s,g)}}},on=(e,{returnsValue:t=!1,argNames:n=[],cleanups:r=new Map}={})=>{let s="";if(t){let c=/(\/(\\\/|[^/])*\/|"(\\"|[^"])*"|'(\\'|[^'])*'|`(\\`|[^`])*`|\(\s*((function)\s*\(\s*\)|(\(\s*\))\s*=>)\s*(?:\{[\s\S]*?\}|[^;){]*)\s*\)\s*\(\s*\)|[^;])+/gm,l=e.trim().match(c);if(l){let u=l.length-1,d=l[u].trim();d.startsWith("return")||(l[u]=`return (${d});`),s=l.join(`;
`)}}else s=e.trim();let i=new Map,o=RegExp(`(?:${Ge})(.*?)(?:${je})`,"gm"),a=0;for(let c of s.matchAll(o)){let l=c[1],u=`__escaped${a++}`;i.set(u,l),s=s.replace(Ge+l+je,u)}s=s.replace(/\$\['([a-zA-Z_$\d][\w$]*)'\]/g,"$$$1").replace(/\$([a-zA-Z_\d]\w*(?:[.-]\w+)*)/g,(c,l)=>l.split(".").reduce((u,d)=>`${u}['${d}']`,"$")),s=s.replaceAll(/@([A-Za-z_$][\w$]*)\(/g,'__action("$1",evt,');for(let[c,l]of i)s=s.replace(c,l);try{let c=Function("el","$","__action","evt",...n,s);return(l,...u)=>{let d=(h,f,...m)=>{let g=ye.bind(0,{plugin:{type:"action",name:h},element:{id:l.id,tag:l.tagName},expression:{fnContent:s,value:e}}),E=Rt[h];if(E)return E({el:l,evt:f,error:g,cleanups:r},...m);throw g("UndefinedAction")};try{return c(l,ne,d,void 0,...u)}catch(h){throw console.error(h),ye({element:{id:l.id,tag:l.tagName},expression:{fnContent:s,value:e},error:h.message},"ExecuteExpression")}}}catch(c){throw console.error(c),ye({expression:{fnContent:s,value:e},error:c.message},"GenerateExpression")}};O({name:"peek",apply(e,t){C();try{return t()}finally{F()}}});O({name:"setAll",apply(e,t,n){C();let r=D(n);te(r,()=>t),P(r),F()}});O({name:"toggleAll",apply(e,t){C();let n=D(t);te(n,r=>!r),P(n),F()}});var Lt=new WeakMap,Se=(e,t,n=!0)=>O({name:e,apply:async({el:r,evt:s,error:i,cleanups:o},a,{selector:c,headers:l,contentType:u="json",filterSignals:{include:d=/.*/,exclude:h=/(^|\.)_/}={},openWhenHidden:f=n,payload:m,requestCancellation:g="auto",retry:E="auto",retryInterval:R=1e3,retryScaler:S=2,retryMaxWaitMs:H=3e4,retryMaxCount:de=10}={})=>{let B=g instanceof AbortController?g:new AbortController;(g==="auto"||g==="cleanup")&&(Lt.get(r)?.abort(),Lt.set(r,B)),g==="cleanup"&&(o.get(`@${e}`)?.(),o.set(`@${e}`,async()=>{B.abort(),await Promise.resolve()}));let me=null;try{if(!a?.length)throw i("FetchNoUrlProvided",{action:O});let I={Accept:"text/event-stream, text/html, application/json","Datastar-Request":!0};u==="json"&&(I["Content-Type"]="application/json");let $=Object.assign({},I,l),X={method:t,headers:$,openWhenHidden:f,retry:E,retryInterval:R,retryScaler:S,retryMaxWaitMs:H,retryMaxCount:de,signal:B.signal,onopen:async y=>{y.status>=400&&re(an,r,{status:y.status.toString()})},onmessage:y=>{if(!y.event.startsWith("datastar"))return;let U=y.event,b={};for(let v of y.data.split(`
`)){let w=v.indexOf(" "),_=v.slice(0,w),V=v.slice(w+1);(b[_]||=[]).push(V)}let K=Object.fromEntries(Object.entries(b).map(([v,w])=>[v,w.join(`
`)]));re(U,r,K)},onerror:y=>{if(Nt(y))throw y("FetchExpectedTextEventStream",{url:a});y&&(console.error(y.message),re(cn,r,{message:y.message}))}},Ve=()=>{let y=new URL(a,document.baseURI),U=new URLSearchParams(y.search);if(u==="json"){C(),m=m!==void 0?m:D({include:d,exclude:h}),F();let b=JSON.stringify(m);t==="GET"?U.set("datastar",b):X.body=b}else if(u==="form"){let b=c?document.querySelector(c):r.closest("form");if(!b)throw i("FetchFormNotFound",{action:O,selector:c});if(!b.noValidate&&!b.checkValidity()){b.reportValidity();return}let K=new FormData(b),v=r;if(r===b&&s instanceof SubmitEvent)v=s.submitter;else{let V=ie=>ie.preventDefault();b.addEventListener("submit",V),me=()=>{b.removeEventListener("submit",V)}}if(v instanceof HTMLButtonElement){let V=v.getAttribute("name");V&&K.append(V,v.value)}let w=b.getAttribute("enctype")==="multipart/form-data";w||($["Content-Type"]="application/x-www-form-urlencoded");let _=new URLSearchParams(K);if(t==="GET")for(let[V,ie]of _)U.append(V,ie);else w?X.body=K:X.body=_}else throw i("FetchInvalidContentType",{action:O,contentType:u});return y.search=U.toString(),X.input=y.toString(),X};re(Xe,r,{});try{await pn(r,Ve)}catch(y){if(!Nt(y))throw i("FetchFailed",{method:t,url:a,error:y.message})}}finally{re(et,r,{}),me?.(),o.delete(`@${e}`)}}});Se("get","GET",!1);Se("patch","PATCH");Se("post","POST");Se("put","PUT");Se("delete","DELETE");var Xe="started",et="finished",an="error",cn="retrying",ln="retries-failed",re=(e,t,n)=>document.dispatchEvent(new CustomEvent(G,{detail:{type:e,el:t,argsRaw:n}})),Nt=e=>`${e}`.includes("text/event-stream"),un=async(e,t)=>{let n=e.getReader(),r=await n.read();for(;!r.done;)t(r.value),r=await n.read()},fn=e=>{let t,n,r,s=!1;return i=>{t?t=mn(t,i):(t=i,n=0,r=-1);let o=t.length,a=0;for(;n<o;){s&&(t[n]===10&&(a=++n),s=!1);let c=-1;for(;n<o&&c===-1;++n)switch(t[n]){case 58:r===-1&&(r=n-a);break;case 13:s=!0;case 10:c=n;break}if(c===-1)break;e(t.subarray(a,c),r),a=n,r=-1}a===o?t=void 0:a&&(t=t.subarray(a),n-=a)}},dn=(e,t,n)=>{let r=Ct(),s=new TextDecoder;return(i,o)=>{if(!i.length)n?.(r),r=Ct();else if(o>0){let a=s.decode(i.subarray(0,o)),c=o+(i[o+1]===32?2:1),l=s.decode(i.subarray(c));switch(a){case"data":r.data=r.data?`${r.data}
${l}`:l;break;case"event":r.event=l;break;case"id":e(r.id=l);break;case"retry":{let u=+l;Number.isNaN(u)||t(r.retry=u);break}}}}},mn=(e,t)=>{let n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n},Ct=()=>({data:"",event:"",id:"",retry:void 0}),pn=(e,t)=>new Promise((n,r)=>{let{input:s,signal:i,headers:o,onopen:a,onmessage:c,onclose:l,onerror:u,openWhenHidden:d,fetch:h,retry:f="auto",retryInterval:m=1e3,retryScaler:g=2,retryMaxWaitMs:E=3e4,retryMaxCount:R=10,responseOverrides:S,...H}=t(),de={...o},B,me=()=>{B.abort(),document.hidden||b()};d||document.addEventListener("visibilitychange",me);let I,$=()=>{document.removeEventListener("visibilitychange",me),clearTimeout(I),B.abort()};i?.addEventListener("abort",()=>{$(),n()});let X=h||window.fetch,Ve=a||(()=>{}),y=0,U=m,b=async()=>{B=new AbortController;let K=B.signal;try{let v=await X(s,{...H,headers:de,signal:K});await Ve(v);let w=async(q,pe,Ie,we,...Kt)=>{let at={[Ie]:await pe.text()};for(let $e of Kt){let qe=pe.headers.get(`datastar-${he($e)}`);if(we){let Re=we[$e];Re&&(qe=typeof Re=="string"?Re:JSON.stringify(Re))}qe&&(at[$e]=qe)}re(q,e,at),$(),n()},_=v.status,V=_===204,ie=_>=300&&_<400,Ut=_>=400&&_<600;if(_!==200){if(l?.(),f!=="never"&&!V&&!ie&&(f==="always"||f==="error"&&Ut)){clearTimeout(I),I=setTimeout(b,m);return}$(),n();return}y=0,m=U;let De=v.headers.get("Content-Type");if(De?.includes("text/html"))return await w("datastar-patch-elements",v,"elements",S,"selector","mode","namespace","useViewTransition");if(De?.includes("application/json"))return await w("datastar-patch-signals",v,"signals",S,"onlyIfMissing");if(De?.includes("text/javascript")){let q=document.createElement("script"),pe=v.headers.get("datastar-script-attributes");if(pe)for(let[Ie,we]of Object.entries(JSON.parse(pe)))q.setAttribute(Ie,we);q.textContent=await v.text(),document.head.appendChild(q),$();return}if(await un(v.body,fn(dn(q=>{q?de["last-event-id"]=q:delete de["last-event-id"]},q=>{U=m=q},c))),l?.(),f==="always"&&!ie){clearTimeout(I),I=setTimeout(b,m);return}$(),n()}catch(v){if(!K.aborted)try{let w=u?.(v)||m;clearTimeout(I),I=setTimeout(b,w),m=Math.min(m*g,E),++y>=R?(re(ln,e,{}),$(),r("Max retries reached.")):console.error(`Datastar failed to reach ${s.toString()} retrying in ${w}ms.`)}catch(w){$(),r(w)}}};b()});p({name:"attr",requirement:{value:"must"},returnsValue:!0,apply({el:e,key:t,rx:n}){let r=(a,c)=>{c===""||c===!0?e.setAttribute(a,""):c===!1||c==null?e.removeAttribute(a):typeof c=="string"?e.setAttribute(a,c):e.setAttribute(a,JSON.stringify(c))},s=t?()=>{i.disconnect();let a=n();r(t,a),i.observe(e,{attributeFilter:[t]})}:()=>{i.disconnect();let a=n(),c=Object.keys(a);for(let l of c)r(l,a[l]);i.observe(e,{attributeFilter:c})},i=new MutationObserver(s),o=T(s);return()=>{i.disconnect(),o()}}});var gn=/^data:(?<mime>[^;]+);base64,(?<contents>.*)$/,Ft=Symbol("empty"),Pt=W("bind");p({name:"bind",requirement:"exclusive",apply({el:e,key:t,mods:n,value:r,error:s}){let i=t!=null?L(t,n):r,o=(f,m)=>m==="number"?+f.value:f.value,a=f=>{e.value=`${f}`};if(e instanceof HTMLInputElement)switch(e.type){case"range":case"number":o=(f,m)=>m==="string"?f.value:+f.value;break;case"checkbox":o=(f,m)=>f.value!=="on"?m==="boolean"?f.checked:f.checked?f.value:"":m==="string"?f.checked?f.value:"":f.checked,a=f=>{e.checked=typeof f=="string"?f===e.value:f};break;case"radio":e.getAttribute("name")?.length||e.setAttribute("name",i),o=(f,m)=>f.checked?m==="number"?+f.value:f.value:Ft,a=f=>{e.checked=f===(typeof f=="number"?+e.value:e.value)};break;case"file":{let f=()=>{let m=[...e.files||[]],g=[];Promise.all(m.map(E=>new Promise(R=>{let S=new FileReader;S.onload=()=>{if(typeof S.result!="string")throw s("InvalidFileResultType",{resultType:typeof S.result});let H=S.result.match(gn);if(!H?.groups)throw s("InvalidDataUri",{result:S.result});g.push({name:E.name,contents:H.groups.contents,mime:H.groups.mime})},S.onloadend=()=>R(),S.readAsDataURL(E)}))).then(()=>{A([[i,g]])})};return e.addEventListener("change",f),e.addEventListener("input",f),()=>{e.removeEventListener("change",f),e.removeEventListener("input",f)}}}else if(e instanceof HTMLSelectElement){if(e.multiple){let f=new Map;o=m=>[...m.selectedOptions].map(g=>{let E=f.get(g.value);return E==="string"||E==null?g.value:+g.value}),a=m=>{for(let g of e.options)m.includes(g.value)?(f.set(g.value,"string"),g.selected=!0):m.includes(+g.value)?(f.set(g.value,"number"),g.selected=!0):g.selected=!1}}}else e instanceof HTMLTextAreaElement||(o=f=>"value"in f?f.value:f.getAttribute("value"),a=f=>{"value"in e?e.value=f:e.setAttribute("value",f)});let c=oe(i),l=typeof c,u=i;if(Array.isArray(c)&&!(e instanceof HTMLSelectElement&&e.multiple)){let f=t||r,m=document.querySelectorAll(`[${Pt}\\:${CSS.escape(f)}],[${Pt}="${CSS.escape(f)}"]`),g=[],E=0;for(let R of m){if(g.push([`${u}.${E}`,o(R,"none")]),e===R)break;E++}A(g,{ifMissing:!0}),u=`${u}.${E}`}else A([[u,o(e,l)]],{ifMissing:!0});let d=()=>{let f=oe(u);if(f!=null){let m=o(e,typeof f);m!==Ft&&A([[u,m]])}};e.addEventListener("input",d),e.addEventListener("change",d);let h=T(()=>{a(oe(u))});return()=>{h(),e.removeEventListener("input",d),e.removeEventListener("change",d)}}});p({name:"class",requirement:{value:"must"},returnsValue:!0,apply({key:e,el:t,mods:n,rx:r}){e&&=L(e,n,"kebab");let s,i=()=>{o.disconnect(),s=e?{[e]:r()}:r();for(let c in s){let l=c.split(/\s+/).filter(u=>u.length>0);if(s[c])for(let u of l)t.classList.contains(u)||t.classList.add(u);else for(let u of l)t.classList.contains(u)&&t.classList.remove(u)}o.observe(t,{attributeFilter:["class"]})},o=new MutationObserver(i),a=T(i);return()=>{o.disconnect(),a();for(let c in s){let l=c.split(/\s+/).filter(u=>u.length>0);for(let u of l)t.classList.remove(u)}}}});p({name:"computed",requirement:{value:"must"},returnsValue:!0,apply({key:e,mods:t,rx:n,error:r}){if(e)A([[L(e,t),ke(n)]]);else{let s=Object.assign({},n());te(s,i=>{if(typeof i=="function")return ke(i);throw r("ComputedExpectedFunction")}),P(s)}}});p({name:"effect",requirement:{key:"denied",value:"must"},apply:({rx:e})=>T(e)});p({name:"indicator",requirement:"exclusive",apply({el:e,key:t,mods:n,value:r}){let s=t!=null?L(t,n):r;A([[s,!1]]);let i=o=>{let{type:a,el:c}=o.detail;if(c===e)switch(a){case Xe:A([[s,!0]]);break;case et:A([[s,!1]]);break}};return document.addEventListener(G,i),()=>{A([[s,!1]]),document.removeEventListener(G,i)}}});var Z=e=>{if(!e||e.size<=0)return 0;for(let t of e){if(t.endsWith("ms"))return+t.replace("ms","");if(t.endsWith("s"))return+t.replace("s","")*1e3;try{return Number.parseFloat(t)}catch{}}return 0},se=(e,t,n=!1)=>e?e.has(t.toLowerCase()):n;var tt=(e,t)=>(...n)=>{setTimeout(()=>{e(...n)},t)},Ot=(e,t,n=!0,r=!1,s=!1)=>{let i=null,o=0;return(...a)=>{n&&!o?(e(...a),i=null):i=a,(!o||s)&&(o&&clearTimeout(o),o=setTimeout(()=>{r&&i!==null&&e(...i),i=null,o=0},t))}},ce=(e,t)=>{let n=t.get("delay");if(n){let i=Z(n);e=tt(e,i)}let r=t.get("debounce");if(r){let i=Z(r),o=se(r,"leading",!1),a=!se(r,"notrailing",!1);e=Ot(e,i,o,a,!0)}let s=t.get("throttle");if(s){let i=Z(s),o=!se(s,"noleading",!1),a=se(s,"trailing",!1);e=Ot(e,i,o,a)}return e};var nt=!!document.startViewTransition,Y=(e,t)=>{if(t.has("viewtransition")&&nt){let n=e;e=(...r)=>document.startViewTransition(()=>n(...r))}return e};p({name:"init",requirement:{key:"denied",value:"must"},apply({rx:e,mods:t}){let n=()=>{M(),e(),x()};n=Y(n,t);let r=0,s=t.get("delay");s&&(r=Z(s),r>0&&(n=tt(n,r))),n()}});p({name:"json-signals",requirement:{key:"denied"},apply({el:e,value:t,mods:n}){let r=n.has("terse")?0:2,s={};t&&(s=ae(t));let i=()=>{o.disconnect(),e.textContent=JSON.stringify(D(s),null,r),o.observe(e,{childList:!0,characterData:!0,subtree:!0})},o=new MutationObserver(i),a=T(i);return()=>{o.disconnect(),a()}}});p({name:"on",requirement:"must",argNames:["evt"],apply({el:e,key:t,mods:n,rx:r}){let s=e;n.has("window")&&(s=window);let i=c=>{c&&(n.has("prevent")&&c.preventDefault(),n.has("stop")&&c.stopPropagation()),M(),r(c),x()};i=Y(i,n),i=ce(i,n);let o={capture:n.has("capture"),passive:n.has("passive"),once:n.has("once")};if(n.has("outside")){s=document;let c=i;i=l=>{e.contains(l?.target)||c(l)}}let a=L(t,n,"kebab");if((a===G||a===ee)&&(s=document),e instanceof HTMLFormElement&&a==="submit"){let c=i;i=l=>{l?.preventDefault(),c(l)}}return s.addEventListener(a,i,o),()=>{s.removeEventListener(a,i)}}});var kt=(e,t,n)=>Math.max(t,Math.min(n,e));var rt=new WeakSet;p({name:"on-intersect",requirement:{key:"denied",value:"must"},apply({el:e,mods:t,rx:n}){let r=()=>{M(),n(),x()};r=Y(r,t),r=ce(r,t);let s={threshold:0};t.has("full")?s.threshold=1:t.has("half")?s.threshold=.5:t.get("threshold")&&(s.threshold=kt(Number(t.get("threshold")),0,100)/100);let i=t.has("exit"),o=new IntersectionObserver(a=>{for(let c of a)c.isIntersecting!==i&&(r(),o&&rt.has(e)&&o.disconnect())},s);return o.observe(e),t.has("once")&&rt.add(e),()=>{t.has("once")||rt.delete(e),o&&(o.disconnect(),o=null)}}});p({name:"on-interval",requirement:{key:"denied",value:"must"},apply({mods:e,rx:t}){let n=()=>{M(),t(),x()};n=Y(n,e);let r=1e3,s=e.get("duration");s&&(r=Z(s),se(s,"leading",!1)&&n());let i=setInterval(n,r);return()=>{clearInterval(i)}}});p({name:"on-signal-patch",requirement:{value:"must"},argNames:["patch"],returnsValue:!0,apply({el:e,key:t,mods:n,rx:r,error:s}){if(t&&t!=="filter")throw s("KeyNotAllowed");let i=W(`${this.name}-filter`),o=e.getAttribute(i),a={};o&&(a=ae(o));let c=!1,l=ce(u=>{if(c)return;let d=D(a,u.detail);if(!lt(d)){c=!0,M();try{r(d)}finally{x(),c=!1}}},n);return document.addEventListener(ee,l),()=>{document.removeEventListener(ee,l)}}});p({name:"ref",requirement:"exclusive",apply({el:e,key:t,mods:n,value:r}){let s=t!=null?L(t,n):r;A([[s,e]])}});var Ht="none",_t="display";p({name:"show",requirement:{key:"denied",value:"must"},returnsValue:!0,apply({el:e,rx:t}){let n=()=>{r.disconnect(),t()?e.style.display===Ht&&e.style.removeProperty(_t):e.style.setProperty(_t,Ht),r.observe(e,{attributeFilter:["style"]})},r=new MutationObserver(n),s=T(n);return()=>{r.disconnect(),s()}}});p({name:"signals",returnsValue:!0,apply({key:e,mods:t,rx:n}){let r=t.has("ifmissing");if(e){e=L(e,t);let s=n?.();A([[e,s]],{ifMissing:r})}else{let s=Object.assign({},n?.());P(s,{ifMissing:r})}}});p({name:"style",requirement:{value:"must"},returnsValue:!0,apply({key:e,el:t,rx:n}){let{style:r}=t,s=new Map,i=(l,u)=>{let d=s.get(l);!u&&u!==0?d!==void 0&&(d?r.setProperty(l,d):r.removeProperty(l)):(d===void 0&&s.set(l,r.getPropertyValue(l)),r.setProperty(l,String(u)))},o=()=>{if(a.disconnect(),e)i(e,n());else{let l=n();for(let[u,d]of s)u in l||(d?r.setProperty(u,d):r.removeProperty(u));for(let u in l)i(he(u),l[u])}a.observe(t,{attributeFilter:["style"]})},a=new MutationObserver(o),c=T(o);return()=>{a.disconnect(),c();for(let[l,u]of s)u?r.setProperty(l,u):r.removeProperty(l)}}});p({name:"text",requirement:{key:"denied",value:"must"},returnsValue:!0,apply({el:e,rx:t}){let n=()=>{r.disconnect(),e.textContent=`${t()}`,r.observe(e,{childList:!0,characterData:!0,subtree:!0})},r=new MutationObserver(n),s=T(n);return()=>{r.disconnect(),s()}}});var Vt=(e,t)=>e.includes(t),hn=["remove","outer","inner","replace","prepend","append","before","after"],yn=["html","svg","mathml"];Ee({name:"datastar-patch-elements",apply(e,t){let n=typeof t.selector=="string"?t.selector:"",r=typeof t.mode=="string"?t.mode:"outer",s=typeof t.namespace=="string"?t.namespace:"html",i=typeof t.useViewTransition=="string"?t.useViewTransition:"",o=t.elements;if(!Vt(hn,r))throw e.error("PatchElementsInvalidMode",{mode:r});if(!n&&r!=="outer"&&r!=="replace")throw e.error("PatchElementsExpectedSelector");if(!Vt(yn,s))throw e.error("PatchElementsInvalidNamespace",{namespace:s});let a={selector:n,mode:r,namespace:s,useViewTransition:i.trim()==="true",elements:o};nt&&a.useViewTransition?document.startViewTransition(()=>Dt(e,a)):Dt(e,a)}});var Dt=({error:e},{selector:t,mode:n,namespace:r,elements:s})=>{let i=document.createDocumentFragment(),o=typeof s!="string"&&!!s;if(typeof s=="string"){let a=s.replace(/<svg(\s[^>]*>|>)([\s\S]*?)<\/svg>/gim,""),c=/<\/html>/.test(a),l=/<\/head>/.test(a),u=/<\/body>/.test(a),d=r==="svg"?"svg":r==="mathml"?"math":"",h=d?`<${d}>${s}</${d}>`:s,f=new DOMParser().parseFromString(c||l||u?s:`<body><template>${h}</template></body>`,"text/html");if(c)i.appendChild(f.documentElement);else if(l&&u)i.appendChild(f.head),i.appendChild(f.body);else if(l)i.appendChild(f.head);else if(u)i.appendChild(f.body);else if(d){let m=f.querySelector("template").content.querySelector(d);for(let g of m.childNodes)i.appendChild(g)}else i=f.querySelector("template").content}else s&&(s instanceof DocumentFragment?i=s:s instanceof Element&&i.appendChild(s));if(!t&&(n==="outer"||n==="replace")){let a=Array.from(i.children);for(let c of a){let l;if(c instanceof HTMLHtmlElement)l=document.documentElement;else if(c instanceof HTMLBodyElement)l=document.body;else if(c instanceof HTMLHeadElement)l=document.head;else if(l=document.getElementById(c.id),!l){console.warn(e("PatchElementsNoTargetsFound"),{element:{id:c.id}});continue}$t(n,c,[l],o)}}else{let a=document.querySelectorAll(t);if(!a.length){console.warn(e("PatchElementsNoTargetsFound"),{selector:t});return}let c=o&&n!=="remove"?[a[0]]:a;$t(n,i,c,o)}},it=new WeakSet;for(let e of document.querySelectorAll("script"))it.add(e);var jt=e=>{let t=e instanceof HTMLScriptElement?[e]:e.querySelectorAll("script");for(let n of t)if(!it.has(n)){let r=document.createElement("script");for(let{name:s,value:i}of n.attributes)r.setAttribute(s,i);r.text=n.text,n.replaceWith(r),it.add(r)}},It=(e,t,n,r)=>{let s=!1;for(let i of e){if(r&&s)break;let o=r?t:t.cloneNode(!0);jt(o),i[n](o),s=!0}},$t=(e,t,n,r)=>{switch(e){case"remove":for(let s of n)s.remove();break;case"outer":case"inner":{let s=!1;for(let i of n){if(r&&s)break;let o=r?t:t.cloneNode(!0);vn(i,o,e),jt(i);let a=i.closest("[data-scope-children]");a&&a.dispatchEvent(new CustomEvent("datastar:scope-children",{bubbles:!1})),s=!0}}break;case"replace":It(n,t,"replaceWith",r);break;case"prepend":case"append":case"before":case"after":It(n,t,e,r)}},k=new Map,ue=new Set,le=new Map,Te=new Set,fe=document.createElement("div");fe.hidden=!0;var Ae=W("ignore-morph"),bn=`[${Ae}]`,vn=(e,t,n="outer")=>{if(Q(e)&&Q(t)&&e.hasAttribute(Ae)&&t.hasAttribute(Ae)||e.parentElement?.closest(bn))return;let r=document.createElement("div");r.append(t),document.body.insertAdjacentElement("afterend",fe);let s=e.querySelectorAll("[id]");for(let{id:a,tagName:c}of s)le.has(a)?Te.add(a):le.set(a,c);e instanceof Element&&e.id&&(le.has(e.id)?Te.add(e.id):le.set(e.id,e.tagName)),ue.clear();let i=r.querySelectorAll("[id]");for(let{id:a,tagName:c}of i)ue.has(a)?Te.add(a):le.get(a)===c&&ue.add(a);for(let a of Te)ue.delete(a);le.clear(),Te.clear(),k.clear();let o=n==="outer"?e.parentElement:e;Gt(o,s),Gt(r,i),Wt(o,r,n==="outer"?e:null,e.nextSibling),fe.remove()},Wt=(e,t,n=null,r=null)=>{e instanceof HTMLTemplateElement&&t instanceof HTMLTemplateElement&&(e=e.content,t=t.content),n??=e.firstChild;for(let s of t.childNodes){if(n&&n!==r){let i=En(s,n,r);if(i){if(i!==n){let o=n;for(;o&&o!==i;){let a=o;o=o.nextSibling,ot(a)}}st(i,s),n=i.nextSibling;continue}}if(s instanceof Element&&ue.has(s.id)){let i=document.getElementById(s.id),o=i;for(;o=o.parentNode;){let a=k.get(o);a&&(a.delete(s.id),a.size||k.delete(o))}Bt(e,i,n),st(i,s),n=i.nextSibling;continue}if(k.has(s)){let i=s.namespaceURI,o=s.tagName,a=i&&i!=="http://www.w3.org/1999/xhtml"?document.createElementNS(i,o):document.createElement(o);e.insertBefore(a,n),st(a,s),n=a.nextSibling}else{let i=document.importNode(s,!0);e.insertBefore(i,n),n=i.nextSibling}}for(;n&&n!==r;){let s=n;n=n.nextSibling,ot(s)}},En=(e,t,n)=>{let r=null,s=e.nextSibling,i=0,o=0,a=k.get(e)?.size||0,c=t;for(;c&&c!==n;){if(qt(c,e)){let l=!1,u=k.get(c),d=k.get(e);if(d&&u){for(let h of u)if(d.has(h)){l=!0;break}}if(l)return c;if(!r&&!k.has(c)){if(!a)return c;r=c}}if(o+=k.get(c)?.size||0,o>a)break;r===null&&s&&qt(c,s)&&(i++,s=s.nextSibling,i>=2&&(r=void 0)),c=c.nextSibling}return r||null},qt=(e,t)=>e.nodeType===t.nodeType&&e.tagName===t.tagName&&(!e.id||e.id===t.id),ot=e=>{k.has(e)?Bt(fe,e,null):e.parentNode?.removeChild(e)},Bt=ot.call.bind(fe.moveBefore??fe.insertBefore),Sn=W("preserve-attr"),st=(e,t)=>{let n=t.nodeType;if(n===1){let r=e,s=t,i=r.hasAttribute("data-scope-children");if(r.hasAttribute(Ae)&&s.hasAttribute(Ae))return e;r instanceof HTMLInputElement&&s instanceof HTMLInputElement&&s.type!=="file"?s.getAttribute("value")!==r.getAttribute("value")&&(r.value=s.getAttribute("value")??""):r instanceof HTMLTextAreaElement&&s instanceof HTMLTextAreaElement&&(s.value!==r.value&&(r.value=s.value),r.firstChild&&r.firstChild.nodeValue!==s.value&&(r.firstChild.nodeValue=s.value));let o=(t.getAttribute(Sn)??"").split(" ");for(let{name:a,value:c}of s.attributes)r.getAttribute(a)!==c&&!o.includes(a)&&r.setAttribute(a,c);for(let a=r.attributes.length-1;a>=0;a--){let{name:c}=r.attributes[a];!s.hasAttribute(c)&&!o.includes(c)&&r.removeAttribute(c)}i&&!r.hasAttribute("data-scope-children")&&r.setAttribute("data-scope-children",""),r instanceof HTMLTemplateElement&&s instanceof HTMLTemplateElement?r.innerHTML=s.innerHTML:r.isEqualNode(s)||Wt(r,s),i&&r.dispatchEvent(new CustomEvent("datastar:scope-children",{bubbles:!1}))}return(n===8||n===3)&&e.nodeValue!==t.nodeValue&&(e.nodeValue=t.nodeValue),e},Gt=(e,t)=>{for(let n of t)if(ue.has(n.id)){let r=n;for(;r&&r!==e;){let s=k.get(r);s||(s=new Set,k.set(r,s)),s.add(n.id),r=r.parentElement}}};Ee({name:"datastar-patch-signals",apply({error:e},{signals:t,onlyIfMissing:n}){if(typeof t!="string")throw e("PatchSignalsExpectedSignals");let r=typeof n=="string"&&n.trim()==="true";P(ae(t),{ifMissing:r})}});export{O as action,Rt as actions,p as attribute,M as beginBatch,ke as computed,T as effect,x as endBatch,D as filtered,oe as getPath,P as mergePatch,A as mergePaths,ne as root,ge as signal,C as startPeeking,F as stopPeeking,Ee as watcher};
//# sourceMappingURL=datastar.js.map
