// Datastar v1.0.0-RC.11
var Ze=/ðŸ–•JS_DSðŸš€/.source,ve=Ze.slice(0,5),Ie=Ze.slice(4),P="datastar",Ye="Datastar-Request",Xe=1e3;var et=!1,$e="outer",tt="inner",nt="remove",it="replace",st="prepend",rt="append",ot="before",at="after",ct=$e,se="datastar-patch-elements",re="datastar-patch-signals";var J=e=>e!==null&&typeof e=="object"&&(Object.getPrototypeOf(e)===Object.prototype||Object.getPrototypeOf(e)===null);function lt(e){for(let t in e)if(Object.hasOwn(e,t))return!1;return!0}function oe(e,t){for(let n in e){let i=e[n];J(i)||Array.isArray(i)?oe(i,t):e[n]=t(i)}}var m=(e,t)=>{for(let n in t){let i=n.split("."),s=i.pop(),o=i.reduce((r,a)=>r[a]??={},e);o[s]=t[n]}return e};function ye(e){return e instanceof HTMLElement||e instanceof SVGElement}function z(e){return e?.closest("[data-scope]")?.dataset.scope??null}var ut=e=>e.trim()==="true",x=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").replace(/([a-z])([0-9]+)/gi,"$1-$2").replace(/([0-9]+)([a-z])/gi,"$1-$2").toLowerCase(),Q=e=>x(e).replace(/-./g,t=>t[1].toUpperCase()),ae=e=>x(e).replace(/-/g,"_"),En=e=>Q(e).replace(/(^.|(?<=\.).)/g,t=>t[0].toUpperCase()),Ee=e=>{try{return JSON.parse(e)}catch{return Function(`return (${e})`)()}},hn={kebab:x,snake:ae,pascal:En};function M(e,t){for(let n of t.get("case")||[]){let i=hn[n];i&&(e=i(e))}return e}function H(e,t,n){if(n.has("scoped")){let i=z(t);i&&(e=`${i}.${e}`)}return e}var ft={type:"attribute",name:"computed",keyReq:"must",valReq:"must",isExpr:!0,onLoad:({key:e,mods:t,rx:n,computed:i,merge:s})=>{e=M(e,t),s(m({},{[e]:i(n)}))}};var pt={type:"attribute",name:"effect",keyReq:"denied",valReq:"must",onLoad:({effect:e,rx:t})=>e(t)};var dt={type:"attribute",name:"signals",isExpr:!0,onLoad:({el:e,key:t,mods:n,rx:i,merge:s})=>{let o=n.has("ifmissing"),r=i(),a={ifMissing:o};if(n.has("scoped")){let c=z(e);s(c?{[c]:r}:r,a)}else s(t!==""?m({},{[M(t,n)]:r}):r,a)}};var bn="https://data-star.dev/errors";function mt(e,t,n={}){let i=new Error;i.name=`${P} ${e} error`;let s=ae(t),o=new URLSearchParams({metadata:JSON.stringify(n)}).toString(),r=JSON.stringify(n,null,2);return i.message=`${t}
More info: ${bn}/${e}/${s}?${o}
Context: ${r}`,i}function Z(e,t,n={}){let i={plugin:{name:t.plugin.name,type:t.plugin.type}};return mt("init",e,Object.assign(i,n))}function gt(e,t,n={}){let i={plugin:{name:e.plugin.name,type:e.plugin.type},element:{id:e.el.id,tag:e.el.tagName},expression:{rawKey:e.rawKey,key:e.key,value:e.value,fnContent:e.fnContent}};return mt("runtime",t,Object.assign(i,n))}var he=`${P}-signal-patch`;var D={},He=[],ue=0,be=0,_e=0,_,Y=e=>Rn.bind(0,{previousValue:e,t:e,e:1}),yt=Symbol("computed"),Et=e=>{let t=Sn.bind(0,{e:17,getter:e});return t[yt]=1,t},ht=e=>{let t={p:e,e:2};_&&je(t,_);let n=N(t);try{t.p()}finally{N(n)}return At.bind(0,t)},Ne=e=>{let t=N(void 0);try{return e()}finally{N(t)}},Ve=()=>{for(;be<_e;){let e=He[be];He[be++]=void 0,Rt(e,e.e&=-65)}if(be=0,_e=0,!lt(D)){let e=D;D={},document.dispatchEvent(new CustomEvent(he,{detail:e}))}},vt=e=>"getter"in e?bt(e):St(e,e.t),N=e=>{let t=_;return _=e,t},bt=e=>{let t=N(e);Tt(e);try{let n=e.t;return n!==(e.t=e.getter(n))}finally{N(t),xt(e)}},St=(e,t)=>(e.e=1,e.previousValue!==(e.previousValue=t)),qe=e=>{let t=e.e;if(!(t&64)){e.e=t|64;let n=e.r;n?qe(n.o):He[_e++]=e}},Rt=(e,t)=>{if(t&16||t&32&&Mt(e.s,e)){let i=N(e);Tt(e);try{e.p()}finally{N(i),xt(e)}return}t&32&&(e.e=t&-33);let n=e.s;for(;n;){let i=n.c,s=i.e;s&64&&Rt(i,i.e=s&-65),n=n.n}},Sn=e=>{let t=e.e;if(t&16||t&32&&Mt(e.s,e)){if(bt(e)){let n=e.r;n&&Ae(n)}}else t&32&&(e.e=t&-33);return _&&je(e,_),e.t},Rn=(e,...t)=>{if(t.length){let n=t[0];if(e.t!==(e.t=n)){e.e=17;let i=e.r;return i&&(An(i),ue||Ve()),!0}return!1}else{let n=e.t;if(e.e&16&&St(e,n)){let i=e.r;i&&Ae(i)}return _&&je(e,_),n}},At=e=>{let t=e.s;for(;t;)t=Re(t,e);let n=e.r;n&&Re(n),e.e=0},je=(e,t)=>{let n=t.a;if(n&&n.c===e)return;let i,s=t.e&4;if(s&&(i=n?n.n:t.s,i&&i.c===e)){t.a=i;return}let o=e.d;if(o&&o.o===t&&(!s||Lt(o,t)))return;let r=t.a=e.d={c:e,o:t,l:n,n:i,u:o};i&&(i.l=r),n?n.n=r:t.s=r,o?o.i=r:e.r=r},Re=(e,t=e.o)=>{let n=e.c,i=e.l,s=e.n,o=e.i,r=e.u;if(s?s.l=i:t.a=i,i?i.n=s:t.s=s,o?o.u=r:n.d=r,r)r.i=o;else if(!(n.r=o))if("getter"in n){let a=n.s;if(a){n.e=17;do a=Re(a,n);while(a)}}else"previousValue"in n||At(n);return s},An=e=>{let t=e.i,n;e:for(;;){let i=e.o,s=i.e;if(s&3&&(s&60?s&12?s&4?!(s&48)&&Lt(e,i)?(i.e=s|40,s&=1):s=0:i.e=s&-9|32:s=0:i.e=s|32,s&2&&qe(i),s&1)){let o=i.r;if(o){e=o,o.i&&(n={t,f:n},t=e.i);continue}}if(e=t){t=e.i;continue}for(;n;)if(e=n.t,n=n.f,e){t=e.i;continue e}break}},Tt=e=>{e.a=void 0,e.e=e.e&-57|4},xt=e=>{let t=e.a,n=t?t.n:e.s;for(;n;)n=Re(n,e);e.e&=-5},Mt=(e,t)=>{let n,i=0;e:for(;;){let s=e.c,o=s.e,r=!1;if(t.e&16)r=!0;else if((o&17)===17){if(vt(s)){let a=s.r;a.i&&Ae(a),r=!0}}else if((o&33)===33){(e.i||e.u)&&(n={t:e,f:n}),e=s.s,t=s,++i;continue}if(!r&&e.n){e=e.n;continue}for(;i;){--i;let a=t.r,c=a.i;if(c?(e=n.t,n=n.f):e=a,r){if(vt(t)){c&&Ae(a),t=e.o;continue}}else t.e&=-33;if(t=e.o,e.n){e=e.n;continue e}r=!1}return r}},Ae=e=>{do{let t=e.o,n=e.i,i=t.e;(i&48)===32&&(t.e=i|16,i&2&&qe(t)),e=n}while(e)},Lt=(e,t)=>{let n=t.a;if(n){let i=t.s;do{if(i===e)return!0;if(i===n)break;i=i.n}while(i)}return!1},Ge=e=>e.split(".").reduce((t,n)=>t[n],V),wt=e=>Ne(()=>e.split(".").reduce((t,n)=>t&&Object.hasOwn(t,n)?t[n]:void 0,V)!==void 0),ce=(e,t="")=>{let n=Array.isArray(e);if(n||J(e)){let i=n?[]:{};for(let o in e)i[o]=Y(ce(e[o],`${t+o}.`));let s=Y(!0);return new Proxy(i,{get:(o,r)=>{if(!(r==="toJSON"&&!Object.hasOwn(i,r)))return n&&r in Array.prototype?(s(),i[r]):(Object.hasOwn(i,r)||(i[r]=Y(""),m(D,{[t+r]:""}),s(!s())),i[r]())},set:(o,r,a)=>{if(n&&r==="length")return i[r]=a,s(!s()),!0;if(Object.hasOwn(i,r)){if(a==null)return delete i[r],m(D,{[t+r]:null}),s(!s()),!0;i[r](ce(a,`${t+r}.`))&&m(D,{[t+r]:a})}else{if(a==null)return!0;Object.hasOwn(a,yt)?(i[r]=a,m(D,{[t+r]:""})):(i[r]=Y(ce(a,`${t+r}.`)),m(D,{[t+r]:a})),s(!s())}return!0},deleteProperty:(o,r)=>(Object.hasOwn(i,r)&&(delete i[r],m(D,{[t+r]:null}),s(!s())),!0),ownKeys:()=>(s(),Reflect.ownKeys(i)),has(o,r){return s(),r in i}})}return e},Ct=(e,{ifMissing:t}={})=>{ue++;for(let n in e)e[n]===null||e[n]===void 0?t||delete V[n]:Ot(e[n],n,V,t);!--ue&&Ve()},Ot=(e,t,n,i)=>{if(J(e)){!J(n[t])&&!Array.isArray(n[t])&&(n[t]=ce({}));for(let s in e)e[s]===null||e[s]===void 0?i||delete n[t][s]:Ot(e[s],s,n[t],i)}else(!i||!Object.hasOwn(n,t))&&(n[t]=e)};function Pt({include:e=/.*/,exclude:t=/(?!)/}={},n=V){let i=RegExp(e),s=RegExp(t),o={},r=[[n,""]];for(;r.length;){let[a,c]=r.pop();for(let l in a)J(a[l])?r.push([a[l],`${c+l}.`]):i.test(c+l)&&!s.test(c+l)&&(o[c+l]=Ge(c+l))}return m({},o)}var V=ce({}),fe={},Se=[],Ft=[],le=new Map,De=null,pe="";function kt(e){pe=e}function F(e){return pe?`data-${pe}-${e}`:`data-${e}`}function xe(...e){for(let t of e){let n={plugin:t,actions:fe,root:V,filtered:Pt,signal:Y,computed:Et,effect:ht,merge:Ct,peek:Ne,getPath:Ge,hasPath:wt};if(t.type==="action")fe[t.name]=t;else if(t.type==="attribute")Se.push(t),t.onGlobalInit?.(n);else if(t.type==="watcher")t.onGlobalInit?.(n);else throw Z("InvalidPluginType",n)}Se.sort((t,n)=>{let i=n.name.length-t.name.length;return i!==0?i:t.name.localeCompare(n.name)}),Ft=Se.map(t=>RegExp(`^${t.name}([A-Z]|_|$)`))}function Te(e){for(let t of e)for(let n in t.dataset)It(t,n,t.dataset[n])}function We(e=document.body){queueMicrotask(()=>{Te([e]),Te(e.querySelectorAll("*")),De||(De=new MutationObserver(Tn),De.observe(e,{subtree:!0,childList:!0,attributes:!0}))})}function It(e,t,n){let i=Q(pe?t.slice(pe.length):t),s=Se.find((o,r)=>Ft[r].test(i));if(s){let[o,...r]=i.slice(s.name.length).split(/__+/),a=!!o;a&&(o=Q(o));let c=!!n,l={el:e,rawKey:i,key:o,value:n,mods:new Map,root:V,filtered:Pt,merge:Ct,signal:Y,computed:Et,effect:ht,plugin:s,actions:fe,peek:Ne,getPath:Ge,hasPath:wt,runtimeErr:0,rx:0};l.runtimeErr=gt.bind(0,l),l.rx=xn(l);let p=s.keyReq||"allowed";if(a){if(p==="denied")throw l.runtimeErr(`${s.name}KeyNotAllowed`)}else if(p==="must")throw l.runtimeErr(`${s.name}KeyRequired`);let d=s.valReq||"allowed";if(c){if(d==="denied")throw l.runtimeErr(`${s.name}ValueNotAllowed`)}else if(d==="must")throw l.runtimeErr(`${s.name}ValueRequired`);if(p==="exclusive"||d==="exclusive"){if(a&&c)throw l.runtimeErr(`${s.name}KeyAndValueProvided`);if(!a&&!c)throw l.runtimeErr(`${s.name}KeyOrValueRequired`)}for(let f of r){let[y,...g]=f.split(".");l.mods.set(Q(y),new Set(g.map(E=>E.toLowerCase())))}ue++;let u=s.onLoad(l);if(!--ue&&Ve(),u){let f=le.get(e);f?f.get(i)?.():(f=new Map,le.set(e,f)),f.set(i,u)}}}function Tn(e){let t=`[${F("ignore")}]`;for(let{target:n,type:i,attributeName:s,addedNodes:o,removedNodes:r}of e)if(i==="childList"){for(let a of r)if(ye(a)){let c=le.get(a);if(le.delete(a)){for(let l of c.values())l();c.clear()}}for(let a of o)ye(a)&&(Te([a]),Te(a.querySelectorAll("*")))}else if(i==="attributes"&&ye(n)&&!n.closest(t)){let a=Q(s.slice(5)),c=n.getAttribute(s);if(c===null){let l=le.get(n);l&&(l.get(a)?.(),l.delete(a))}else It(n,a,c)}}function xn(e){let t="",n=e.plugin||void 0;if(n?.isExpr){let d=/(\/(\\\/|[^/])*\/|"(\\"|[^"])*"|'(\\'|[^'])*'|`(\\`|[^`])*`|\(\s*((function)\s*\(\s*\)|(\(\s*\))\s*=>)\s*(?:\{[\s\S]*?\}|[^;){]*)\s*\)\s*\(\s*\)|[^;])+/gm,u=e.value.trim().match(d);if(u){let f=u.length-1,y=u[f].trim();y.startsWith("return")||(u[f]=`return (${y});`),t=u.join(`;
`)}}else t=e.value.trim();t=t.replace(/\$\$([a-zA-Z_][\w.-]*(?:\.[a-zA-Z_][\w.-]*)*?)(?=\s|$|[^\w.-])/g,(d,u)=>{let f=z(e.el);return f?`$${f}.${u}`:`$${u}`}),t=t.replace(/\$([a-zA-Z_][\w.-]*(?:\.[a-zA-Z_][\w.-]*)*?)(?=\s|$|[^\w.-])/g,(d,u)=>u.endsWith("-")&&d.length<t.length&&t[t.indexOf(d)+d.length]==="$"?(u=u.slice(0,-1),`${u.split(".").reduce((g,E)=>`${g}['${E}']`,"$")}-`):u.split(".").reduce((y,g)=>`${y}['${g}']`,"$"));let i=new Map,s=RegExp(`(?:${ve})(.*?)(?:${Ie})`,"gm");for(let d of t.matchAll(s)){let u=d[1],f=`dsEscaped${Mn(u)}`;i.set(f,u),t=t.replace(ve+u+Ie,f)}let o=(d,u)=>`${d}${ae(u).replaceAll(/\./g,"_")}`,r=new Set,a=RegExp(`@(${Object.keys(fe).join("|")})\\(`,"gm"),c=[...t.matchAll(a)],l=new Set,p=new Set;if(c.length){let d=`${P}Act_`;for(let u of c){let f=u[1],y=fe[f];if(!y)continue;r.add(f);let g=o(d,f);t=t.replace(`@${f}(`,`${g}(`),l.add(g),p.add((...E)=>y.fn(e,...E))}}for(let[d,u]of i)t=t.replace(d,u);e.fnContent=t;try{let d=Function("el","$",...n?.argNames||[],...l,t);return(...u)=>{try{return d(e.el,V,...u,...p)}catch(f){throw e.runtimeErr("ExecuteExpression",{error:f.message})}}}catch(d){throw e.runtimeErr("GenerateExpression",{error:d.message})}}function Mn(e){let t=5831,n=e.length;for(;n--;)t+=(t<<5)+e.charCodeAt(n);return(t>>>0).toString(36)}xe(dt,ft,pt);var q=`${P}-sse`,Me="started",Le="finished",$t="error",Dt="retrying",Ht="retrying";function we(e,t){document.addEventListener(q,n=>{if(n.detail.type===e){let{argsRaw:i}=n.detail;t(i)}})}var U=(e,t,n)=>document.dispatchEvent(new CustomEvent(q,{detail:{type:e,el:t,argsRaw:n}})),_t=e=>`${e}`.includes("text/event-stream"),Vt=async({el:e,evt:t,filtered:n,runtimeErr:i},s,o,{selector:r,headers:a,contentType:c="json",filterSignals:l={include:/.*/,exclude:/(^|\.)_/},openWhenHidden:p=!1,retryInterval:d=Xe,retryScaler:u=2,retryMaxWaitMs:f=3e4,retryMaxCount:y=10,abort:g}={})=>{let E=s.toLowerCase(),h=()=>{};try{if(!o?.length)throw i("SseNoUrlProvided",{action:E});let R={Accept:"text/event-stream, text/html, application/json",[Ye]:!0};c==="json"&&(R["Content-Type"]="application/json");let b=Object.assign({},R,a),T={method:s,headers:b,openWhenHidden:p,retryInterval:d,retryScaler:u,retryMaxWaitMs:f,retryMaxCount:y,signal:g,onopen:async v=>{v.status>=400&&U($t,e,{status:v.status.toString()})},onmessage:v=>{if(!v.event.startsWith(P))return;let W=v.event,k={};for(let C of v.data.split(`
`)){let S=C.indexOf(" "),w=C.slice(0,S),ne=C.slice(S+1);(k[w]||=[]).push(ne)}let K=Object.fromEntries(Object.entries(k).map(([C,S])=>[C,S.join(`
`)]));U(W,e,K)},onerror:v=>{if(_t(v))throw i("InvalidContentType",{url:o});v&&(console.error(v.message),U(Dt,e,{message:v.message}))}},A=new URL(o,window.location.href),L=new URLSearchParams(A.search);if(c==="json"){let v=JSON.stringify(n(l));s==="GET"?L.set(P,v):T.body=v}else if(c==="form"){let v=r?document.querySelector(r):e.closest("form");if(!v)throw i(r?"SseFormNotFound":"SseClosestFormNotFound",{action:E,selector:r});if(!v.checkValidity()){v.reportValidity(),h();return}let W=new FormData(v),k=e;if(e===v&&t instanceof SubmitEvent)k=t.submitter;else{let S=w=>w.preventDefault();v.addEventListener("submit",S),h=()=>v.removeEventListener("submit",S)}if(k instanceof HTMLButtonElement){let S=k.getAttribute("name");S&&W.append(S,k.value)}let K=v.getAttribute("enctype")==="multipart/form-data";K||(b["Content-Type"]="application/x-www-form-urlencoded");let C=new URLSearchParams(W);if(s==="GET")for(let[S,w]of C)L.append(S,w);else K?T.body=W:T.body=C}else throw i("SseInvalidContentType",{action:E,contentType:c});U(Me,e,{}),A.search=L.toString();try{await Pn(A.toString(),e,T)}catch(v){if(!_t(v))throw i("SseFetchFailed",{method:s,url:o,error:v})}}finally{U(Le,e,{}),h()}};async function Ln(e,t){let n=e.getReader(),i=await n.read();for(;!i.done;)t(i.value),i=await n.read()}function wn(e){let t,n,i,s=!1;return function(r){t?t=On(t,r):(t=r,n=0,i=-1);let a=t.length,c=0;for(;n<a;){s&&(t[n]===10&&(c=++n),s=!1);let l=-1;for(;n<a&&l===-1;++n)switch(t[n]){case 58:i===-1&&(i=n-c);break;case 13:s=!0;case 10:l=n;break}if(l===-1)break;e(t.subarray(c,l),i),c=n,i=-1}c===a?t=void 0:c&&(t=t.subarray(c),n-=c)}}function Cn(e,t,n){let i=Nt(),s=new TextDecoder;return function(r,a){if(!r.length)n?.(i),i=Nt();else if(a>0){let c=s.decode(r.subarray(0,a)),l=a+(r[a+1]===32?2:1),p=s.decode(r.subarray(l));switch(c){case"data":i.data=i.data?`${i.data}
${p}`:p;break;case"event":i.event=p;break;case"id":e(i.id=p);break;case"retry":{let d=+p;Number.isNaN(d)||t(i.retry=d);break}}}}}var On=(e,t)=>{let n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n},Nt=()=>({data:"",event:"",id:"",retry:void 0});function Pn(e,t,{signal:n,headers:i,onopen:s,onmessage:o,onclose:r,onerror:a,openWhenHidden:c,fetch:l,retryInterval:p=1e3,retryScaler:d=2,retryMaxWaitMs:u=3e4,retryMaxCount:f=10,overrides:y,...g}){return new Promise((E,h)=>{let R={accept:"text/event-stream",...i},b;function T(){b.abort(),document.hidden||C()}c||document.addEventListener("visibilitychange",T);let A=0;function L(){document.removeEventListener("visibilitychange",T),window.clearTimeout(A),b.abort()}n?.addEventListener("abort",()=>{L(),E()});let v=l||window.fetch,W=s||(()=>{}),k=0,K=p;async function C(){b=new AbortController;try{let S=await v(e,{...g,headers:R,signal:b.signal});k=0,p=K,await W(S);let w=async(I,ie,Oe,me,...Pe)=>{let Qe={[Oe]:await ie.text()};for(let Fe of Pe){let ke=ie.headers.get(`datastar-${x(Fe)}`);if(me){let ge=me[Fe];ge&&(ke=typeof ge=="string"?ge:JSON.stringify(ge))}ke&&(Qe[Fe]=ke)}U(I,t,Qe),L()},ne=S.headers.get("Content-Type");if(ne?.includes("text/html"))return await w(se,S,"elements",y,"selector","mode","useViewTransition");if(ne?.includes("application/json"))return await w(re,S,"signals",y,"onlyIfMissing");if(ne?.includes("application/javascript")){let I=document.createElement("script"),ie=S.headers.get("datastar-script-attributes");if(ie)for(let Oe of ie.split(",")){let[me,Pe]=Oe.split("=");I.setAttribute(me,Pe||"")}I.textContent=await S.text(),document.head.appendChild(I),L();return}await Ln(S.body,wn(Cn(I=>{I?R["last-event-id"]=I:delete R["last-event-id"]},I=>{K=p=I},o))),r?.(),L(),E()}catch(S){if(!b.signal.aborted)try{let w=a?.(S)||p;window.clearTimeout(A),A=window.setTimeout(C,w),p=Math.min(p*d,u),++k>=f?(U(Ht,t,{}),L(),h("Max retries reached.")):console.error(`Datastar failed to reach ${e.toString()} retrying in ${w}ms.`)}catch(w){L(),h(w)}}}C()})}var $=(e,t)=>({type:"action",name:e,fn:(n,i,s)=>Vt(n,t,i,s)});var qt=$("delete","DELETE");var jt=$("get","GET");var Gt=$("patch","PATCH");var Wt=$("post","POST");var Kt=$("put","PUT");var Ke=!!document.startViewTransition;function j(e,t){if(t.has("viewtransition")&&Ke){let n=e;e=(...i)=>document.startViewTransition(()=>n(...i))}return e}var zt={type:"watcher",name:se,async onGlobalInit(e){we(se,t=>Fn(e,t))}};function Fn(e,{elements:t,selector:n,mode:i=ct,useViewTransition:s}){let o=document.createElement("template");o.innerHTML=t;for(let r of[...o.content.childNodes]){let a=r.nodeType;if(a!==1){if(a===3&&!r.nodeValue.trim())continue;throw Z("NoElementsFound",e)}let c=n||`#${r.id}`,l=document.querySelectorAll(c);if(!l.length)throw Z("NoTargetsFound",e,{selectorOrId:c});s&&Ke?document.startViewTransition(()=>Ut(e,i,r,l)):Ut(e,i,r,l)}}function Ut(e,t,n,i){for(let s of i){if(t===nt)s.remove();else if(t===$e||t===tt)kn(s,n,t);else{let r=n.cloneNode(!0);if(t===it)s.replaceWith(r);else if(t===st)s.prepend(r);else if(t===rt)s.append(r);else if(t===ot)s.before(r);else if(t===at)s.after(r);else throw Z("InvalidPatchMode",e,{mode:t})}let o=s instanceof HTMLScriptElement?[s]:s.querySelectorAll("script");for(let r of o){let a=document.createElement("script");for(let{name:c,value:l}of r.attributes)a.setAttribute(c,l);a.text=r.text,r.replaceWith(a)}}}var X=new Map,O=new Map,ee=new Set,de=new Set,te=document.createElement("div");te.hidden=!0;function kn(e,t,n){let i=F("ignore-morph");if(e.hasAttribute(i)&&t.hasAttribute(i)||e.parentElement?.closest(`[${i}]`))return;let s=document.createElement("div");s.append(t),document.body.insertAdjacentElement("afterend",te);let o=e.querySelectorAll("[id]");for(let{id:a,tagName:c}of o)X.has(a)?de.add(a):X.set(a,c);e.id&&(X.has(e.id)?de.add(e.id):X.set(e.id,e.tagName)),ee.clear();let r=s.querySelectorAll("[id]");for(let{id:a,tagName:c}of r)ee.has(a)?de.add(a):X.get(a)===c&&ee.add(a);X.clear();for(let a of de)ee.delete(a);de.clear(),O.clear(),Jt(n==="outer"?e.parentElement:e,o),Jt(s,r),Qt(n==="outer"?e.parentElement:e,s,n==="outer"?e:null,e.nextSibling),te.remove()}function Qt(e,t,n=null,i=null){e instanceof HTMLTemplateElement&&t instanceof HTMLTemplateElement&&(e=e.content,t=t.content),n??=e.firstChild;for(let s of t.childNodes){if(n&&n!==i){let r=In(s,n,i);if(r){if(r!==n){let a=n;for(;a&&a!==r;){let c=a;a=a.nextSibling,Be(c)}}Ue(r,s),n=r.nextSibling;continue}}let o=s.id;if(s instanceof Element&&ee.has(o)){let r=window[o],a=r;for(;a=a.parentNode;){let c=O.get(a);c&&(c.delete(o),c.size||O.delete(a))}Zt(e,r,n),Ue(r,s),n=r.nextSibling;continue}if(O.has(s)){let r=document.createElement(s.tagName);e.insertBefore(r,n),Ue(r,s),n=r.nextSibling}else{let r=document.importNode(s,!0);e.insertBefore(r,n),n=r.nextSibling}}for(;n&&n!==i;){let s=n;n=n.nextSibling,Be(s)}}function In(e,t,n){let i=null,s=e.nextSibling,o=0,r=0,a=O.get(e)?.size||0,c=t;for(;c&&c!==n;){if(Bt(c,e)){let l=!1,p=O.get(c),d=O.get(e);if(d&&p){for(let u of p)if(d.has(u)){l=!0;break}}if(l)return c;if(!i&&!O.has(c)){if(!a)return c;i=c}}if(r+=O.get(c)?.size||0,r>a||(i===null&&s&&Bt(c,s)&&(o++,s=s.nextSibling,o>=2&&(i=void 0)),c.contains(document.activeElement)))break;c=c.nextSibling}return i||null}function Bt(e,t){let n=e.id;return e.nodeType===t.nodeType&&e.tagName===t.tagName&&(!n||n===t.id)}function Be(e){O.has(e)?Zt(te,e,null):e.parentNode?.removeChild(e)}var Zt=Be.call.bind(te.moveBefore??te.insertBefore);function Ue(e,t){let n=t.nodeType;if(n===1){let i=F("ignore-morph");if(e.hasAttribute(i)&&t.hasAttribute(i))return e;let s=t.getAttribute(F("preserve-attr"))?.split(" ");for(let{name:r,value:a}of t.attributes)e.getAttribute(r)!==a&&!s?.includes(x(r))&&e.setAttribute(r,a);let o=e.attributes;for(let r=o.length-1;r>=0;r--){let{name:a}=o[r];!t.hasAttribute(a)&&!s?.includes(x(a))&&e.removeAttribute(a)}if(e instanceof HTMLInputElement&&t instanceof HTMLInputElement&&t.type!=="file"){let r=F("bind").slice(5),a=!0;for(let c in t.dataset)if(c.startsWith(r)){a=!1;break}if(a){let c=t.value;t.hasAttribute("value")?e.value!==c&&(e.setAttribute("value",c),e.value=c):(e.value="",e.removeAttribute("value"))}}else if(e instanceof HTMLTextAreaElement&&t instanceof HTMLTextAreaElement){let r=t.value;r!==e.value&&(e.value=r),e.firstChild&&e.firstChild.nodeValue!==r&&(e.firstChild.nodeValue=r)}}return(n===8||n===3)&&e.nodeValue!==t.nodeValue&&(e.nodeValue=t.nodeValue),e.isEqualNode(t)||Qt(e,t),e}function Jt(e,t){for(let n of t)if(ee.has(n.id)){let i=n;for(;i&&i!==e;){let s=O.get(i);s||(s=new Set,O.set(i,s)),s.add(n.id),i=i.parentElement}}}var Yt={type:"watcher",name:re,onGlobalInit:e=>we(re,({signals:t="{}",onlyIfMissing:n=`${et}`})=>e.merge(Ee(t),{ifMissing:ut(n)}))};var Xt={type:"attribute",name:"attr",valReq:"must",isExpr:!0,onLoad:({el:e,effect:t,key:n,rx:i})=>{let s=(c,l)=>{l===""||l===!0?e.setAttribute(c,""):l===!1||l===null||l===void 0?e.removeAttribute(c):e.setAttribute(c,l)};if(n===""){let c=new MutationObserver(()=>{c.disconnect();let p=i();for(let[d,u]of Object.entries(p))s(d,u);c.observe(e,{attributeFilter:Object.keys(p)})}),l=t(()=>{c.disconnect();let p=i();for(let d in p)s(d,p[d]);c.observe(e,{attributeFilter:Object.keys(p)})});return()=>{c.disconnect(),l()}}let o=x(n),r=new MutationObserver(()=>{r.disconnect();let c=i();s(o,c),r.observe(e,{attributeFilter:[c]})}),a=t(()=>{r.disconnect();let c=i();s(o,c),r.observe(e,{attributeFilter:[c]})});return()=>{r.disconnect(),a()}}};var $n=/^data:(?<mime>[^;]+);base64,(?<contents>.*)$/,Dn=/email|password|search|tel|text|url/,Hn=/number|range/,en={type:"attribute",name:"bind",keyReq:"exclusive",valReq:"exclusive",onLoad:({el:e,key:t,mods:n,value:i,effect:s,merge:o,runtimeErr:r,getPath:a,hasPath:c})=>{let l=t?M(t,n):i;if(l=H(l,e,n),e instanceof HTMLInputElement&&Dn.test(e.type)||e instanceof HTMLTextAreaElement){if(Array.isArray(c(l)&&a(l))){let y=n.has("scoped")?"__scoped":"",g=document.querySelectorAll(`[${F("bind")}${y}-${t}],[${F("bind")}${y}="${i}"]`),E=0,h={};for(let T of g){if(c(`${l}.${E}`)||(h[`${l}.${E}`]=T.value),e===T)break;E++}o(m({},h));let R=()=>{o(m({},{[`${l}.${E}`]:e.value}))};e.addEventListener("change",R),e.addEventListener("input",R);let b=s(()=>e.value=a(l)[E]);return()=>{b(),e.removeEventListener("change",R),e.removeEventListener("input",R)}}o(m({},{[l]:e.value}),{ifMissing:!0});let u=()=>o(m({},{[l]:e.value}));e.addEventListener("change",u),e.addEventListener("input",u);let f=s(()=>e.value=a(l));return()=>{f(),e.removeEventListener("change",u),e.removeEventListener("input",u)}}if(e instanceof HTMLInputElement){if(e.type==="checkbox"){if(Array.isArray(c(l)&&a(l))){let g=n.has("scoped")?"__scoped":"",E=document.querySelectorAll(`[${F("bind")}${g}-${t}],[${F("bind")}${g}="${i}"]`),h=0,R={};for(let A of E){if(!c(`${l}.${h}`)){let L=A.getAttribute("value");R[`${l}.${h}`]=L?A.checked?L:"":A.checked}if(e===A)break;h++}o(m({},R));let b=()=>{let A=e.getAttribute("value");o(m({},{[`${l}.${h}`]:A?e.checked?A:"":e.checked}))};e.addEventListener("change",b),e.addEventListener("input",b);let T=s(()=>{let A=e.getAttribute("value");e.checked=A?A===a(l)[h]:a(l)[h]});return()=>{T(),e.removeEventListener("change",b),e.removeEventListener("input",b)}}let u=e.getAttribute("value");o(m({},{[l]:u?e.checked?u:"":e.checked}));let f=()=>{let g=e.getAttribute("value");o(m({},{[l]:g?e.checked?g:"":e.checked}))};e.addEventListener("change",f),e.addEventListener("input",f);let y=s(()=>{let g=e.getAttribute("value");e.checked=g?g===a(l):a(l)});return()=>{y(),e.removeEventListener("change",f),e.removeEventListener("input",f)}}if(e.type==="radio"){e.getAttribute("name")?.length||e.setAttribute("name",l),o(m({},{[l]:e.value}),{ifMissing:!0});let u=()=>e.checked&&o(m({},{[l]:e.value}));e.addEventListener("change",u),e.addEventListener("input",u);let f=s(()=>e.checked=e.value===a(l));return()=>{f(),e.removeEventListener("change",u),e.removeEventListener("input",u)}}if(Hn.test(e.type)){o(m({},{[l]:+e.value}),{ifMissing:!0});let u=()=>o(m({},{[l]:+e.value}));e.addEventListener("change",u),e.addEventListener("input",u);let f=s(()=>e.value=a(l));return()=>{f(),e.removeEventListener("change",u),e.removeEventListener("input",u)}}if(e.type==="file"){let u=()=>{let f=[...e.files||[]],y=[],g=[],E=[];Promise.all(f.map(h=>new Promise(R=>{let b=new FileReader;b.onload=()=>{if(typeof b.result!="string")throw r("InvalidFileResultType",{resultType:typeof b.result});let T=b.result.match($n);if(!T?.groups)throw r("InvalidDataUri",{result:b.result});y.push(T.groups.contents),g.push(T.groups.mime),E.push(h.name)},b.onloadend=()=>R(),b.readAsDataURL(h)}))).then(()=>{o(m({},{[l]:y,[`${l}Mimes`]:g,[`${l}Names`]:E}))})};return e.addEventListener("change",u),e.addEventListener("input",u),()=>{e.removeEventListener("change",u),e.removeEventListener("input",u)}}}if(e instanceof HTMLSelectElement){if(e.multiple){o(m({},{[l]:[...e.selectedOptions].map(h=>h.value)}),{ifMissing:!0});let g=()=>o(m({},{[l]:[...e.selectedOptions].map(h=>h.value)}));e.addEventListener("change",g),e.addEventListener("input",g);let E=s(()=>{let h=a(l);for(let R of e.options)R.selected=h.includes(R.value)});return()=>{E(),e.removeEventListener("change",g),e.removeEventListener("input",g)}}o(m({},{[l]:e.value}),{ifMissing:!0});let u=()=>o(m({},{[l]:e.value}));e.addEventListener("change",u),e.addEventListener("input",u);let y=s(()=>e.value=a(l));return()=>{y(),e.removeEventListener("change",u),e.removeEventListener("input",u)}}o(m({},{[l]:e.getAttribute("value")}),{ifMissing:!0});let p=new MutationObserver(()=>{o(m({},{[l]:e.getAttribute("value")}))});p.observe(e,{attributeFilter:["value"]});let d=s(()=>e.setAttribute("value",a(l)));return()=>{d(),p.disconnect()}}};var tn={type:"attribute",name:"class",valReq:"must",isExpr:!0,onLoad:({key:e,el:t,effect:n,mods:i,rx:s})=>{if(e===""){let c=new MutationObserver(()=>{c.disconnect();let p=s();for(let[d,u]of Object.entries(p)){let f=d.split(/\s+/);u?t.classList.add(...f):t.classList.remove(...f)}c.observe(t,{attributeFilter:["class"]})}),l=n(()=>{c.disconnect();let p=s();for(let[d,u]of Object.entries(p)){let f=d.split(/\s+/);u?t.classList.add(...f):t.classList.remove(...f)}c.observe(t,{attributeFilter:["class"]})});return()=>{c.disconnect(),l()}}let o=x(e);o=M(o,i);let r=new MutationObserver(()=>{r.disconnect(),s()?t.classList.add(o):t.classList.remove(o),r.observe(t,{attributeFilter:["class"]})}),a=n(()=>{r.disconnect(),s()?t.classList.add(o):t.classList.remove(o),r.observe(t,{attributeFilter:["class"]})});return()=>{r.disconnect(),a()}}};var nn={type:"attribute",name:"indicator",keyReq:"exclusive",valReq:"exclusive",onLoad:({el:e,key:t,mods:n,merge:i,value:s})=>{let o=t?M(t,n):s;o=H(o,e,n),i(m({},{[o]:!1}),{ifMissing:!0});let r=a=>{let{type:c,el:l}=a.detail;if(l===e)switch(c){case Me:i(m({},{[o]:!0}));break;case Le:i(m({},{[o]:!1}));break}};return document.addEventListener(q,r),()=>{i(m({},{[o]:!1})),document.removeEventListener(q,r)}}};var sn={type:"attribute",name:"jsonSignals",keyReq:"denied",onLoad:({el:e,effect:t,value:n,filtered:i,mods:s})=>{let o=s.has("terse")?0:2,r={};n&&(r=Ee(n));let a=()=>{c.disconnect(),e.textContent=JSON.stringify(i(r),null,o),c.observe(e,{childList:!0})},c=new MutationObserver(a),l=t(a);return()=>{c.disconnect(),l()}}};function G(e){if(!e||e.size<=0)return 0;for(let t of e){if(t.endsWith("ms"))return+t.replace("ms","");if(t.endsWith("s"))return+t.replace("s","")*1e3;try{return Number.parseFloat(t)}catch{}}return 0}function B(e,t,n=!1){return e?e.has(t.toLowerCase()):n}function Je(e,t){return(...n)=>{setTimeout(()=>{e(...n)},t)}}function _n(e,t,n=!1,i=!0){let s=0;return(...o)=>{s&&clearTimeout(s),n&&!s&&e(...o),s=setTimeout(()=>{i&&e(...o),s&&clearTimeout(s)},t)}}function Nn(e,t,n=!0,i=!1){let s=!1;return(...o)=>{s||(n&&e(...o),s=!0,setTimeout(()=>{s=!1,i&&e(...o)},t))}}function Ce(e,t){let n=t.get("delay");if(n){let o=G(n);e=Je(e,o)}let i=t.get("debounce");if(i){let o=G(i),r=B(i,"leading",!1),a=!B(i,"notrail",!1);e=_n(e,o,r,a)}let s=t.get("throttle");if(s){let o=G(s),r=!B(s,"noleading",!1),a=B(s,"trail",!1);e=Nn(e,o,r,a)}return e}var rn={type:"attribute",name:"on",keyReq:"must",valReq:"must",argNames:["evt"],onLoad:e=>{let{el:t,key:n,mods:i,rx:s}=e,o=t;i.has("window")&&(o=window);let r=l=>{if(l){if(i.has("prevent")&&l.preventDefault(),i.has("stop")&&l.stopPropagation(),!(l.isTrusted||l instanceof CustomEvent||i.has("trust")))return;e.evt=l}s(l)};r=Ce(r,i),r=j(r,i);let a={capture:i.has("capture"),passive:i.has("passive"),once:i.has("once")};if(i.has("outside")){o=document;let l=r;r=p=>{t.contains(p?.target)||l(p)}}let c=x(n);if(c=M(c,i),(c===q||c===he)&&(o=document),t instanceof HTMLFormElement&&c==="submit"){let l=r;r=p=>{p?.preventDefault(),l(p)}}return o.addEventListener(c,r,a),()=>{o.removeEventListener(c,r)}}};var ze=new WeakSet,on={type:"attribute",name:"onIntersect",keyReq:"denied",onLoad:({el:e,mods:t,rx:n})=>{let i=()=>n();i=Ce(i,t),i=j(i,t);let s={threshold:0};t.has("full")?s.threshold=1:t.has("half")&&(s.threshold=.5);let o=new IntersectionObserver(r=>{for(let a of r)a.isIntersecting&&(i(),o&&ze.has(e)&&o.disconnect())},s);return o.observe(e),t.has("once")&&ze.add(e),()=>{t.has("once")||ze.delete(e),o&&(o.disconnect(),o=null)}}};var an={type:"attribute",name:"onInterval",keyReq:"denied",valReq:"must",onLoad:({mods:e,rx:t})=>{let n=()=>t();n=j(n,e);let i=1e3,s=e.get("duration");s&&(i=G(s),B(s,"leading",!1)&&n());let o=setInterval(n,i);return()=>{clearInterval(o)}}};var cn={type:"attribute",name:"onLoad",keyReq:"denied",valReq:"must",onLoad:({rx:e,mods:t})=>{let n=()=>e();n=j(n,t);let i=0,s=t.get("delay");s&&(i=G(s)),n=Je(n,i),n()}};var ln={type:"attribute",name:"ref",keyReq:"exclusive",valReq:"exclusive",onLoad:({key:e,mods:t,value:n,el:i,merge:s})=>{let o=e?M(e,t):n;o=H(o,i,t),s(m({},{[o]:i}))}};var Vn=0,un={type:"attribute",name:"scope",keyReq:"denied",onLoad:({el:e,value:t,mods:n,merge:i})=>{let s=t||`_${e.closest("[id]")?.id||crypto.randomUUID()}${Vn++}`;e.parentElement&&(s=H(s,e.parentElement,n));let o=s.split(".").reduceRight((r,a)=>({[a]:r}),{});return i(o),e.setAttribute("data-scope",s),e.removeAttribute("data-scope__scoped"),()=>{let a=s.split(".").reduceRight((c,l)=>({[l]:c}),null);i(a)}}};var fn="none",pn="display",dn={type:"attribute",name:"show",keyReq:"denied",valReq:"must",isExpr:!0,onLoad:({el:e,effect:t,rx:n})=>{let i=()=>{s.disconnect(),n()?e.style.display===fn&&e.style.removeProperty(pn):e.style.setProperty(pn,fn),s.observe(e,{attributeFilter:["style"]})},s=new MutationObserver(i),o=t(i);return()=>{s.disconnect(),o()}}};var mn={type:"attribute",name:"text",keyReq:"denied",valReq:"must",isExpr:!0,onLoad:({el:e,effect:t,rx:n})=>{let i=()=>{s.disconnect(),e.textContent=`${n()}`,s.observe(e,{childList:!0})},s=new MutationObserver(i),o=t(i);return()=>{s.disconnect(),o()}}};var gn={type:"action",name:"peek",fn:({peek:e},t)=>e(t)};var vn={type:"action",name:"setAll",fn:({filtered:e,merge:t,peek:n},i,s)=>{n(()=>{let o=e(s);oe(o,()=>i),t(o)})}};var yn={type:"action",name:"toggleAll",fn:({filtered:e,merge:t,peek:n},i)=>{n(()=>{let s=e(i);oe(s,o=>!o),t(s)})}};xe(jt,Wt,Kt,Gt,qt,zt,Yt,Xt,en,tn,nn,sn,rn,on,an,cn,ln,un,dn,mn,gn,vn,yn);We();export{We as apply,xe as load,kt as setAlias};
//# sourceMappingURL=datastar.js.map
